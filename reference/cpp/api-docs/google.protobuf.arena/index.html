<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>arena.h | Protocol Buffers Documentation</title>
<meta name=description content="This section contains reference documentation for working with protocol buffer classes in C++."><meta property="og:title" content="arena.h"><meta property="og:description" content="This section contains reference documentation for working with protocol buffer classes in C++."><meta property="og:type" content="article"><meta property="og:url" content="https://protobuf.dev/reference/cpp/api-docs/google.protobuf.arena/"><meta property="article:section" content="reference"><meta itemprop=name content="arena.h"><meta itemprop=description content="This section contains reference documentation for working with protocol buffer classes in C++."><meta itemprop=wordCount content="1846"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="arena.h"><meta name=twitter:description content="This section contains reference documentation for working with protocol buffer classes in C++."><link rel=preload href=/scss/main.min.27bc098c9a8f7a1246d474f5c8afcee53760c9c7f38125d343ff52e0bf493011.css as=style integrity="sha256-J7wJjJqPehJG1HT1yK/O5TdgycfzgSXTQ/9S4L9JMBE=" crossorigin=anonymous><link href=/scss/main.min.27bc098c9a8f7a1246d474f5c8afcee53760c9c7f38125d343ff52e0bf493011.css rel=stylesheet integrity="sha256-J7wJjJqPehJG1HT1yK/O5TdgycfzgSXTQ/9S4L9JMBE=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-5L8P8GRN4Y"></script><script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5L8P8GRN4Y")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Protocol Buffers Documentation</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav></ul></div><div class="d-none d-lg-block"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m--li><a href=/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-><span>Protocol Buffers</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-overview-li><a href=/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-overview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-installation-li><a href=/installation/ title="Protocol Buffer Compiler Installation" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-installation><span>Protoc Installation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-news-li><a href=/news/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-news><span>News</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-programming-guides-li><a href=/programming-guides/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-programming-guides><span>Programming Guides</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guideseditions-li><a href=/programming-guides/editions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guideseditions><span>Language Guide (editions)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesproto2-li><a href=/programming-guides/proto2/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesproto2><span>Language Guide (proto 2)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesproto3-li><a href=/programming-guides/proto3/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesproto3><span>Language Guide (proto 3)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesproto-limits-li><a href=/programming-guides/proto-limits/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesproto-limits><span>Proto Limits</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesstyle-li><a href=/programming-guides/style/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesstyle><span>Style Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesenum-li><a href=/programming-guides/enum/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesenum><span>Enum Behavior</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesencoding-li><a href=/programming-guides/encoding/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesencoding><span>Encoding</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesjson-li><a href=/programming-guides/json/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesjson><span>ProtoJSON Format</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidestechniques-li><a href=/programming-guides/techniques/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidestechniques><span>Techniques</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesaddons-li><a href=/programming-guides/addons/ title="Third-Party Add-ons" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesaddons><span>Add-ons</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesextension_declarations-li><a href=/programming-guides/extension_declarations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesextension_declarations><span>Extension Declarations</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesfield_presence-li><a href=/programming-guides/field_presence/ title="Application Note: Field Presence" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesfield_presence><span>Field Presence</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesserialization-not-canonical-li><a href=/programming-guides/serialization-not-canonical/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesserialization-not-canonical><span>Proto Serialization Is Not Canonical</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-programming-guidesdeserialize-debug-li><a href=/programming-guides/deserialize-debug/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-programming-guidesdeserialize-debug><span>Deserializing Debug Proto Representations</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-editions-li><a href=/editions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-editions><span>Protobuf Editions</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-editionsoverview-li><a href=/editions/overview/ title="Protobuf Editions Overview" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-editionsoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-editionsfeatures-li><a href=/editions/features/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-editionsfeatures><span>Feature Settings for Editions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-editionsimplementation-li><a href=/editions/implementation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-editionsimplementation><span>Implementing Editions Support</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-design-decisions-li><a href=/design-decisions/ title="Protobuf Team Design Decisions" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-design-decisions><span>Design Decisions</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-design-decisionsnullable-getters-setters-li><a href=/design-decisions/nullable-getters-setters/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-design-decisionsnullable-getters-setters><span>No Nullable Setters/Getters Support</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-best-practices-li><a href=/best-practices/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-best-practices><span>Proto Best Practices</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-best-practicesno-cargo-cults-li><a href=/best-practices/no-cargo-cults/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-best-practicesno-cargo-cults><span>Avoid Cargo Culting</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-best-practicesdos-donts-li><a href=/best-practices/dos-donts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-best-practicesdos-donts><span>Proto Best Practices</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-best-practicesapi-li><a href=/best-practices/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-best-practicesapi><span>API Best Practices</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-best-practices1-1-1-li><a href=/best-practices/1-1-1/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-best-practices1-1-1><span>1-1-1 Best Practice</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-started-li><a href=/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-getting-started><span>Tutorials</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedcpptutorial-li><a href=/getting-started/cpptutorial/ title="Protocol Buffer Basics: C++" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedcpptutorial><span>C++</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedcsharptutorial-li><a href=/getting-started/csharptutorial/ title="Protocol Buffer Basics: C#" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedcsharptutorial><span>C#</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-starteddarttutorial-li><a href=/getting-started/darttutorial/ title="Protocol Buffer Basics: Dart" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-starteddarttutorial><span>Dart</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedgotutorial-li><a href=/getting-started/gotutorial/ title="Protocol Buffer Basics: Go" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedgotutorial><span>Go</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedjavatutorial-li><a href=/getting-started/javatutorial/ title="Protocol Buffer Basics: Java" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedjavatutorial><span>Java</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedkotlintutorial-li><a href=/getting-started/kotlintutorial/ title="Protocol Buffer Basics: Kotlin" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedkotlintutorial><span>Kotlin</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedpythontutorial-li><a href=/getting-started/pythontutorial/ title="Protocol Buffer Basics: Python" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedpythontutorial><span>Python</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-reference-li><a href=/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-reference><span>Reference Guides</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-referencecpp-li><a href=/reference/cpp/ title="C++ Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencecpp><span>C++</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecppcpp-generated-li><a href=/reference/cpp/cpp-generated/ title="C++ Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecppcpp-generated><span>Generated Code Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecppstring-view-li><a href=/reference/cpp/string-view/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecppstring-view><span>String View APIs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecpparenas-li><a href=/reference/cpp/arenas/ title="C++ Arena Allocation Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecpparenas><span>Arena Allocation Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecppabseil-li><a href=/reference/cpp/abseil/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecppabseil><span>Abseil Support</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecppapi-docs-link-li><a href=/reference/cpp/api-docs/ target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecppapi-docs-link><span>C++ API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencecsharp-li><a href=/reference/csharp/ title="C# Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencecsharp><span>C#</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecsharpcsharp-generated-li><a href=/reference/csharp/csharp-generated/ title="C# Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecsharpcsharp-generated><span>Generated Code Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecsharpapi-docs-link-li><a href=/reference/csharp/api-docs target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencecsharpapi-docs-link><span>C# API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencedart-li><a href=/reference/dart/ title="Dart Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencedart><span>Dart</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencedartdart-generated-li><a href=/reference/dart/dart-generated/ title="Dart Generated Code" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencedartdart-generated><span>Generated Code</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencedartapi-docs-link-li><a href=https://pub.dartlang.org/documentation/protobuf target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencedartapi-docs-link><span>Dart API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencego-li><a href=/reference/go/ title="Go Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencego><span>Go</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegogo-generated-li><a href=/reference/go/go-generated/ title="Go Generated Code Guide (Open)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegogo-generated><span>Generated Code Guide (Open)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegogo-generated-opaque-li><a href=/reference/go/go-generated-opaque/ title="Go Generated Code Guide (Opaque)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegogo-generated-opaque><span>Generated Code Guide (Opaque)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegofaq-li><a href=/reference/go/faq/ title="Go FAQ" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegofaq><span>FAQ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegosize-li><a href=/reference/go/size/ title="Go Size Semantics" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegosize><span>Size Semantics</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegoapi-docs-link-li><a href=https://pkg.go.dev/google.golang.org/protobuf/proto target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegoapi-docs-link><span>Go API</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegoopaque-migration-li><a href=/reference/go/opaque-migration/ title="Go Opaque API Migration" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegoopaque-migration><span>Opaque API Migration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegoopaque-migration-manual-li><a href=/reference/go/opaque-migration-manual/ title="Go Opaque API: Manual Migration" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegoopaque-migration-manual><span>Opaque API: Manual Migration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencegoopaque-faq-li><a href=/reference/go/opaque-faq/ title="Go Opaque API FAQ" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencegoopaque-faq><span>Opaque API FAQ</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencejava-li><a href=/reference/java/ title="Java Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencejava><span>Java</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencejavajava-generated-li><a href=/reference/java/java-generated/ title="Java Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencejavajava-generated><span>Generated Code Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencejavajava-proto-names-li><a href=/reference/java/java-proto-names/ title="Java Proto Names" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencejavajava-proto-names><span>Generated Proto Names</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencejavaapi-docs-link-li><a href=/reference/java/api-docs/overview-summary.html target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencejavaapi-docs-link><span>Java API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencekotlin-li><a href=/reference/kotlin/ title="Kotlin Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencekotlin><span>Kotlin</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencekotlinapi-docs-li><a href=/reference/kotlin/api-docs/ title="Kotlin Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencekotlinapi-docs><span>Kotlin</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencekotlinkotlin-generated-li><a href=/reference/kotlin/kotlin-generated/ title="Kotlin Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencekotlinkotlin-generated><span>Generated Code Guide</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceobjective-c-li><a href=/reference/objective-c/ title="Objective-C Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referenceobjective-c><span>Objective-C</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceobjective-cobjective-c-generated-li><a href=/reference/objective-c/objective-c-generated/ title="Objective-C Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceobjective-cobjective-c-generated><span>Generated Code Guide</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencephp-li><a href=/reference/php/ title="PHP Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencephp><span>PHP</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencephpphp-generated-li><a href=/reference/php/php-generated/ title="PHP Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencephpphp-generated><span>Generated Code Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencephpapi-docs-link-li><a href=/reference/php/api-docs/ target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencephpapi-docs-link><span>PHP API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencepython-li><a href=/reference/python/ title="Python Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referencepython><span>Python</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencepythonpython-generated-li><a href=/reference/python/python-generated/ title="Python Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencepythonpython-generated><span>Generated Code Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencepythonapi-docs-link-li><a href=https://googleapis.dev/python/protobuf/latest/ target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencepythonapi-docs-link><span>Python API</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceruby-li><a href=/reference/ruby/ title="Ruby Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referenceruby><span>Ruby</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencerubyruby-generated-li><a href=/reference/ruby/ruby-generated/ title="Ruby Generated Code Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referencerubyruby-generated><span>Generated Code Guide</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceprotobuf-li><a href=/reference/protobuf/ title="Protocol Buffers Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-referenceprotobuf><span>Protocol Buffers</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceprotobufedition-2023-spec-li><a href=/reference/protobuf/edition-2023-spec/ title="Protocol Buffers Edition 2023 Language Specification" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceprotobufedition-2023-spec><span>2023 Language Specification</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceprotobufproto2-spec-li><a href=/reference/protobuf/proto2-spec/ title="Protocol Buffers Version 2 Language Specification" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceprotobufproto2-spec><span>Version 2 Language Specification</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceprotobufproto3-spec-li><a href=/reference/protobuf/proto3-spec/ title="Protocol Buffers Version 3 Language Specification" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceprotobufproto3-spec><span>Version 3 Language Specification</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceprotobuftextformat-spec-li><a href=/reference/protobuf/textformat-spec/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceprotobuftextformat-spec><span>Text Format Language Specification</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceprotobufgoogleprotobuf-li><a href=/reference/protobuf/google.protobuf/ title="Protocol Buffers Well-Known Types" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceprotobufgoogleprotobuf><span>Well-Known Types</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceother-li><a href=/reference/other/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-referenceother><span>Other Languages</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-support-li><a href=/support/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-support><span>Support</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-supportversion-support-li><a href=/support/version-support/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-supportversion-support><span>Version Support</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-supportmigration-li><a href=/support/migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-supportmigration><span>Migration Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-supportcross-version-runtime-guarantee-li><a href=/support/cross-version-runtime-guarantee/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-supportcross-version-runtime-guarantee><span>Cross-Version Runtime Guarantee</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-downloads-li><a href=/downloads/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-downloads><span>Downloads</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-history-li><a href=/history/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-history><span>History</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-forum-link-li><a href=https://groups.google.com/g/protobuf target=_blank rel=noopener class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-forum-link><span>Forum</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-navbar-li><a href=/navbar/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-navbar><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-search-li><a href=/search/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-search><span>Search Results</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/protocolbuffers/protocolbuffers.github.io/tree/main/content/reference/cpp/api-docs/google.protobuf.arena.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/protocolbuffers/protocolbuffers.github.io/edit/main/content/reference/cpp/api-docs/google.protobuf.arena.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/protocolbuffers/protocolbuffers.github.io/new/main/content/reference/cpp/api-docs/google.protobuf.arena.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/protocolbuffers/protocolbuffers.github.io/issues/new?title=arena.h" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/protocolbuffers/protobuf/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/reference/>Reference Guides</a></li><li class=breadcrumb-item><a href=/reference/cpp/>C++</a></li><li class=breadcrumb-item><a href=/reference/cpp/api-docs/>C++</a></li><li class="breadcrumb-item active" aria-current=page>C++</li></ol></nav><div class=td-content><h1>arena.h</h1><div class=lead>This section contains reference documentation for working with protocol buffer classes in C++.</div><header class=article-meta></header><p><code>#include &lt;google/protobuf/arena.h><br>namespace <a href=#google.protobuf>google::protobuf</a></code></p><p>This file defines an <a href=#Arena>Arena</a> allocator for better allocation performance.</p><table width=100%><tr><th colspan=2><h3 style=margin-top:4px>Classes in this file</h3></th></tr><tr><td><div><code><a href=#ArenaOptions>ArenaOptions</a></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px><a href=#ArenaOptions>ArenaOptions</a> provides optional additional parameters to arena construction that control its block-allocation behavior.</div></td></tr><tr><td><div><code><a href=#Arena>Arena</a></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px><a href=#Arena>Arena</a> allocator.</div></td></tr><tr><td><div><code><a href=#Arena.InternalHelper>Arena::InternalHelper</a></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px></div></td></tr><tr><td><div><code><a href=#Arena.is_arena_constructable>Arena::is_arena_constructable</a></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Helper typetraits that indicates support for arenas in a type T at compile time.</div></td></tr><tr><td><div><code><a href=#Arena.is_destructor_skippable>Arena::is_destructor_skippable</a></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px></div></td></tr></table><h2 id=ArenaOptions>struct ArenaOptions</h2><p><code>#include &lt;<a href=#>google/protobuf/arena.h</a>><br>namespace <a href=#google.protobuf>google::protobuf</a></code></p><p><a href=#ArenaOptions>ArenaOptions</a> provides optional additional parameters to arena construction that control its block-allocation behavior.</p><table><tr><th colspan=2><h3 style=margin-top:4px>Members</h3></th></tr><tr><td style=border-right-width:0;text-align:right><code>size_t</code></td><td style=border-left-width:0 id=ArenaOptions.start_block_size><div style=padding-left:16px;text-indent:-16px><code><b>start_block_size</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>This defines the size of the first block requested from the system malloc. <a href=#ArenaOptions.start_block_size.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>size_t</code></td><td style=border-left-width:0 id=ArenaOptions.max_block_size><div style=padding-left:16px;text-indent:-16px><code><b>max_block_size</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>This defines the maximum block size requested from system malloc (unless an individual arena allocation request occurs with a size larger than this maximum). <a href=#ArenaOptions.max_block_size.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>char *</code></td><td style=border-left-width:0 id=ArenaOptions.initial_block><div style=padding-left:16px;text-indent:-16px><code><b>initial_block</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>An initial block of memory for the arena to use, or NULL for none. <a href=#ArenaOptions.initial_block.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>size_t</code></td><td style=border-left-width:0 id=ArenaOptions.initial_block_size><div style=padding-left:16px;text-indent:-16px><code><b>initial_block_size</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>The size of the initial block, if provided.</div></td></tr><tr><td style=border-right-width:0;text-align:right><code>void *(*</code></td><td style=border-left-width:0 id=ArenaOptions.block_alloc><div style=padding-left:16px;text-indent:-16px><code><b>block_alloc</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>A function pointer to an alloc method that returns memory blocks of size requested. <a href=#ArenaOptions.block_alloc.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>void(*</code></td><td style=border-left-width:0 id=ArenaOptions.block_dealloc><div style=padding-left:16px;text-indent:-16px><code><b>block_dealloc</b></code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>A function pointer to a dealloc method that takes ownership of the blocks from the arena. <a href=#ArenaOptions.block_dealloc.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code></code></td><td style=border-left-width:0 id=ArenaOptions.ArenaOptions><div style=padding-left:16px;text-indent:-16px><code><b>ArenaOptions</b>()</code></div></td></tr></table><hr><h3 id=ArenaOptions.start_block_size.details><code>size_t ArenaOptions::start_block_size</code></h3><div style=margin-left:16px><p>This defines the size of the first block requested from the system malloc.</p><p>Subsequent block sizes will increase in a geometric series up to a maximum.</p></div><hr><h3 id=ArenaOptions.max_block_size.details><code>size_t ArenaOptions::max_block_size</code></h3><div style=margin-left:16px><p>This defines the maximum block size requested from system malloc (unless an individual arena allocation request occurs with a size larger than this maximum).</p><p>Requested block sizes increase up to this value, then remain here.</p></div><hr><h3 id=ArenaOptions.initial_block.details><code>char * ArenaOptions::initial_block</code></h3><div style=margin-left:16px><p>An initial block of memory for the arena to use, or NULL for none.</p><p>If provided, the block must live at least as long as the arena itself. The creator of the <a href=#Arena>Arena</a> retains ownership of the block after the <a href=#Arena>Arena</a> is destroyed.</p></div><hr><h3 id=ArenaOptions.block_alloc.details><code>void *(* ArenaOptions::block_alloc</code></h3><div style=margin-left:16px><p>A function pointer to an alloc method that returns memory blocks of size requested.</p><p>By default, it contains a ptr to the malloc function.</p><p>NOTE: block_alloc and dealloc functions are expected to behave like malloc and free, including Asan poisoning.</p></div><hr><h3 id=ArenaOptions.block_dealloc.details><code>void(* ArenaOptions::block_dealloc</code></h3><div style=margin-left:16px><p>A function pointer to a dealloc method that takes ownership of the blocks from the arena.</p><p>By default, it contains a ptr to a wrapper function that calls free.</p></div><h2 id=Arena>class Arena</h2><p><code>#include &lt;<a href=#>google/protobuf/arena.h</a>><br>namespace <a href=#google.protobuf>google::protobuf</a></code></p><p><a href=#Arena>Arena</a> allocator.</p><p><a href=#Arena>Arena</a> allocation replaces ordinary (heap-based) allocation with new/delete, and improves performance by aggregating allocations into larger blocks and freeing allocations all at once. Protocol messages are allocated on an arena by using Arena::CreateMessage&lt;T>(Arena*), below, and are automatically freed when the arena is destroyed.</p><p>This is a thread-safe implementation: multiple threads may allocate from the arena concurrently. Destruction is not thread-safe and the destructing thread must synchronize with users of the arena first.</p><p>An arena provides two allocation interfaces: CreateMessage&lt;T>, which works for arena-enabled proto2 message types as well as other types that satisfy the appropriate protocol (described below), and Create&lt;T>, which works for any arbitrary type T. CreateMessage&lt;T> is better when the type T supports it, because this interface (i) passes the arena pointer to the created object so that its sub-objects and internal allocations can use the arena too, and (ii) elides the object's destructor call when possible. Create&lt;T> does not place any special requirements on the type T, and will invoke the object's destructor when the arena is destroyed.</p><p>The arena message allocation protocol, required by <a href=#Arena.CreateMessage>CreateMessage&lt;T>(Arena* arena, Args&&... args)</a>, is as follows:</p><ul><li>The type T must have (at least) two constructors: a constructor callable with <code>args</code> (without <code>arena</code>), called when a T is allocated on the heap; and a constructor callable with <code>Arena* arena, Args&&... args</code>, called when a T is allocated on an arena. If the second constructor is called with a NULL arena pointer, it must be equivalent to invoking the first (<code>args</code>-only) constructor.</li><li>The type T must have a particular type trait: a nested type |InternalArenaConstructable_|. This is usually a typedef to |void|. If no such type trait exists, then the instantiation CreateMessage&lt;T> will fail to compile.</li><li>The type T <i>may</i> have the type trait |DestructorSkippable_|. If this type trait is present in the type, then its destructor will not be called if and only if it was passed a non-NULL arena pointer. If this type trait is not present on the type, then its destructor is always called when the containing arena is destroyed.</li></ul><p>This protocol is implemented by all arena-enabled proto2 message classes as well as protobuf container types like <a href=../google.protobuf.repeated_field#RepeatedPtrField>RepeatedPtrField</a> and <a href=../google.protobuf.map#Map>Map</a>. The protocol is internal to protobuf and is not guaranteed to be stable. Non-proto types should not rely on this protocol.</p><table><tr><th colspan=2><h3 style=margin-top:4px>Members</h3></th></tr><tr><td style=border-right-width:0;text-align:right><code>const size_t</code></td><td style=border-left-width:0 id=Arena.kBlockOverhead><div style=padding-left:16px;text-indent:-16px><code><b>kBlockOverhead</b> = =
internal::ThreadSafeArena::kBlockHeaderSize +
internal::ThreadSafeArena::kSerialArenaSize</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Block overhead. <a href=#Arena.kBlockOverhead.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code></code></td><td style=border-left-width:0 id=Arena.Arena><div style=padding-left:16px;text-indent:-16px><code><b>Arena</b>()</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Default constructor with sensible default options, tuned for average use-cases.</div></td></tr><tr><td style=border-right-width:0;text-align:right><code></code></td><td style=border-left-width:0 id=Arena.Arena><div style=padding-left:16px;text-indent:-16px><code><b>Arena</b>(char * initial_block, size_t initial_block_size)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Construct an arena with default options, except for the supplied initial block. <a href=#Arena.Arena.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>explicit</code></td><td style=border-left-width:0 id=Arena.Arena><div style=padding-left:16px;text-indent:-16px><code><b>Arena</b>(const <a href=#ArenaOptions>ArenaOptions</a> & options)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px><a href=#Arena>Arena</a> constructor taking custom options. <a href=#Arena.Arena.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code></code></td><td style=border-left-width:0 id=Arena.~Arena><div style=padding-left:16px;text-indent:-16px><code><b>~Arena</b>()</code></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>void</code></td><td style=border-left-width:0 id=Arena.Init><div style=padding-left:16px;text-indent:-16px><code><b>Init</b>(const <a href=#ArenaOptions>ArenaOptions</a> & )</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>uint64</code></td><td style=border-left-width:0 id=Arena.SpaceAllocated><div style=padding-left:16px;text-indent:-16px><code><b>SpaceAllocated</b>() const</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>The following are routines are for monitoring. <a href=#Arena.SpaceAllocated.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>uint64</code></td><td style=border-left-width:0 id=Arena.SpaceUsed><div style=padding-left:16px;text-indent:-16px><code><b>SpaceUsed</b>() const</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Returns the total space used by the arena. <a href=#Arena.SpaceUsed.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>uint64</code></td><td style=border-left-width:0 id=Arena.Reset><div style=padding-left:16px;text-indent:-16px><code><b>Reset</b>()</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Frees all storage allocated by this arena after calling destructors registered with <a href=#Arena.OwnDestructor>OwnDestructor()</a> and freeing objects registered with <a href=#Arena.Own>Own()</a>. <a href=#Arena.Reset.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template void</code></td><td style=border-left-width:0 id=Arena.Own><div style=padding-left:16px;text-indent:-16px><code><b>Own</b>(T * object)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Adds |object| to a list of heap-allocated objects to be freed with |delete| when the arena is destroyed or reset.</div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template void</code></td><td style=border-left-width:0 id=Arena.OwnDestructor><div style=padding-left:16px;text-indent:-16px><code><b>OwnDestructor</b>(T * object)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Adds |object| to a list of objects whose destructors will be manually called when the arena is destroyed or reset. <a href=#Arena.OwnDestructor.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>void</code></td><td style=border-left-width:0 id=Arena.OwnCustomDestructor><div style=padding-left:16px;text-indent:-16px><code><b>OwnCustomDestructor</b>(void * object, void(*)(void *) destruct)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Adds a custom member function on an object to the list of destructors that will be manually called when the arena is destroyed or reset. <a href=#Arena.OwnCustomDestructor.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template static T *</code></td><td style=border-left-width:0 id=Arena.CreateMessage><div style=padding-left:16px;text-indent:-16px><code><b>CreateMessage</b>(<a href=#Arena>Arena</a> * arena, Args &&... args)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>API to create proto2 message objects on the arena. <a href=#Arena.CreateMessage.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template static PROTOBUF_NDEBUG_INLINE T *</code></td><td style=border-left-width:0 id=Arena.Create><div style=padding-left:16px;text-indent:-16px><code><b>Create</b>(<a href=#Arena>Arena</a> * arena, Args &&... args)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>API to create any objects on the arena. <a href=#Arena.Create.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template static PROTOBUF_NDEBUG_INLINE T *</code></td><td style=border-left-width:0 id=Arena.CreateArray><div style=padding-left:16px;text-indent:-16px><code><b>CreateArray</b>(<a href=#Arena>Arena</a> * arena, size_t num_elements)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Create an array of object type T on the arena <i>without</i> invoking the constructor of T. <a href=#Arena.CreateArray.details>more...</a></div></td></tr><tr><td style=border-right-width:0;text-align:right><code>template static <a href=#Arena>Arena</a> *</code></td><td style=border-left-width:0 id=Arena.GetArena><div style=padding-left:16px;text-indent:-16px><code><b>GetArena</b>(const T * value)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Retrieves the arena associated with |value| if |value| is an arena-capable message, or NULL otherwise. <a href=#Arena.GetArena.details>more...</a></div></td></tr></table><hr><h3 id=Arena.kBlockOverhead.details><code>const size_t Arena::kBlockOverhead = =
internal::ThreadSafeArena::kBlockHeaderSize +
internal::ThreadSafeArena::kSerialArenaSize</code></h3><div style=margin-left:16px><p>Block overhead.</p><p>Use this as a guide for how much to over-allocate the initial block if you want an allocation of size N to fit inside it.</p><p>WARNING: if you allocate multiple objects, it is difficult to guarantee that a series of allocations will fit in the initial block, especially if <a href=#Arena>Arena</a> changes its alignment guarantees in the future!</p></div><hr><h3 id=Arena.Arena.details><code>Arena::Arena(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char * initial_block,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t initial_block_size)</code></h3><div style=margin-left:16px><p>Construct an arena with default options, except for the supplied initial block.</p><p>It is more efficient to use this constructor instead of passing <a href=#ArenaOptions>ArenaOptions</a> if the only configuration needed by the caller is supplying an initial block.</p></div><hr><h3 id=Arena.Arena.details><code>explicit Arena::Arena(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href=#ArenaOptions>ArenaOptions</a> & options)</code></h3><div style=margin-left:16px><p><a href=#Arena>Arena</a> constructor taking custom options.</p><p>See <a href=#ArenaOptions>ArenaOptions</a> above for descriptions of the options available.</p></div><hr><h3 id=Arena.SpaceAllocated.details><code>uint64 Arena::SpaceAllocated() const</code></h3><div style=margin-left:16px><p>The following are routines are for monitoring.</p><p>They will approximate the total sum allocated and used memory, but the exact value is an implementation deal. For instance allocated space depends on growth policies. Do not use these in unit tests. Returns the total space allocated by the arena, which is the sum of the sizes of the underlying blocks.</p></div><hr><h3 id=Arena.SpaceUsed.details><code>uint64 Arena::SpaceUsed() const</code></h3><div style=margin-left:16px><p>Returns the total space used by the arena.</p><p>Similar to SpaceAllocated but does not include free space and block overhead. The total space returned may not include space used by other threads executing concurrently with the call to this method.</p></div><hr><h3 id=Arena.Reset.details><code>uint64 Arena::Reset()</code></h3><div style=margin-left:16px><p>Frees all storage allocated by this arena after calling destructors registered with <a href=#Arena.OwnDestructor>OwnDestructor()</a> and freeing objects registered with <a href=#Arena.Own>Own()</a>.</p><p>Any objects allocated on this arena are unusable after this call. It also returns the total space used by the arena which is the sums of the sizes of the allocated blocks. This method is not thread-safe.</p></div><hr><h3 id=Arena.OwnDestructor.details><code>template void Arena::OwnDestructor(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T * object)</code></h3><div style=margin-left:16px><p>Adds |object| to a list of objects whose destructors will be manually called when the arena is destroyed or reset.</p><p>This differs from <a href=#Arena.Own>Own()</a> in that it does not free the underlying memory with |delete|; hence, it is normally only used for objects that are placement-newed into arena-allocated memory.</p></div><hr><h3 id=Arena.OwnCustomDestructor.details><code>void Arena::OwnCustomDestructor(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void * object,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void(*)(void *) destruct)</code></h3><div style=margin-left:16px><p>Adds a custom member function on an object to the list of destructors that will be manually called when the arena is destroyed or reset.</p><p>This differs from <a href=#Arena.OwnDestructor>OwnDestructor()</a> in that any member function may be specified, not only the class destructor.</p></div><hr><h3 id=Arena.CreateMessage.details><code>template static T * Arena::CreateMessage(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=#Arena>Arena</a> * arena,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args &&... args)</code></h3><div style=margin-left:16px><p>API to create proto2 message objects on the arena.</p><p>If the arena passed in is NULL, then a heap allocated object is returned. Type T must be a message defined in a .proto file with cc_enable_arenas set to true, otherwise a compilation error will occur.</p><p><a href=../google.protobuf.repeated_field#RepeatedField>RepeatedField</a> and <a href=../google.protobuf.repeated_field#RepeatedPtrField>RepeatedPtrField</a> may also be instantiated directly on an arena with this method.</p><p>This function also accepts any type T that satisfies the arena message allocation protocol, documented above.</p></div><hr><h3 id=Arena.Create.details><code>template static PROTOBUF_NDEBUG_INLINE T *<br>&nbsp;&nbsp;&nbsp;&nbsp;Arena::Create(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=#Arena>Arena</a> * arena,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args &&... args)</code></h3><div style=margin-left:16px><p>API to create any objects on the arena.</p><p>Note that only the object will be created on the arena; the underlying ptrs (in case of a proto2 message) will be still heap allocated. Proto messages should usually be allocated with <a href=#Arena.CreateMessage>CreateMessage&lt;T>()</a> instead.</p><p>Note that even if T satisfies the arena message construction protocol (InternalArenaConstructable_ trait and optional DestructorSkippable_ trait), as described above, this function does not follow the protocol; instead, it treats T as a black-box type, just as if it did not have these traits. Specifically, T's constructor arguments will always be only those passed to <a href=#Arena.Create>Create&lt;T>()</a> &ndash; no additional arena pointer is implicitly added. Furthermore, the destructor will always be called at arena destruction time (unless the destructor is trivial). Hence, from T's point of view, it is as if the object were allocated on the heap (except that the underlying memory is obtained from the arena).</p></div><hr><h3 id=Arena.CreateArray.details><code>template static PROTOBUF_NDEBUG_INLINE T *<br>&nbsp;&nbsp;&nbsp;&nbsp;Arena::CreateArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=#Arena>Arena</a> * arena,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t num_elements)</code></h3><div style=margin-left:16px><p>Create an array of object type T on the arena <i>without</i> invoking the constructor of T.</p><p>If <code>arena</code> is null, then the return value should be freed with <code>delete[] x;</code> (or <code>::operator delete[](x);</code>). To ensure safe uses, this function checks at compile time (when compiled as C++11) that T is trivially default-constructible and trivially destructible.</p></div><hr><h3 id=Arena.GetArena.details><code>template static <a href=#Arena>Arena</a> * Arena::GetArena(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const T * value)</code></h3><div style=margin-left:16px><p>Retrieves the arena associated with |value| if |value| is an arena-capable message, or NULL otherwise.</p><p>If possible, the call resolves at compile time. Note that we can often devirtualize calls to <code>value-><a href=#Arena.GetArena>GetArena()</a></code> so usually calling this method is unnecessary.</p></div><h2 id=Arena.InternalHelper>template class Arena::InternalHelper</h2><p><code>#include &lt;<a href=#>google/protobuf/arena.h</a>><br>namespace <a href=#google.protobuf>google::protobuf</a><br><br>template &lt;typename ></code></p><p></p><table><tr><th colspan=2><h3 style=margin-top:4px>Members</h3></th></tr><tr><td style=border-right-width:0;text-align:right><code>static <a href=#Arena>Arena</a> *</code></td><td style=border-left-width:0 id=Arena.InternalHelper.GetOwningArena><div style=padding-left:16px;text-indent:-16px><code><b>GetOwningArena</b>(const T * p)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Provides access to protected GetOwningArena to generated messages.</div></td></tr><tr><td style=border-right-width:0;text-align:right><code>static <a href=#Arena>Arena</a> *</code></td><td style=border-left-width:0 id=Arena.InternalHelper.GetArenaForAllocation><div style=padding-left:16px;text-indent:-16px><code><b>GetArenaForAllocation</b>(const T * p)</code></div><div style=font-style:italic;margin-top:4px;margin-left:16px>Provides access to protected GetArenaForAllocation to generated messages.</div></td></tr></table><h2 id=Arena.is_arena_constructable>template struct Arena::is_arena_constructable</h2><p><code>#include &lt;<a href=#>google/protobuf/arena.h</a>><br>namespace <a href=#google.protobuf>google::protobuf</a><br><br>template &lt;typename ></code></p><p>Helper typetraits that indicates support for arenas in a type T at compile time.</p><p>This is public only to allow construction of higher-level templated utilities.</p><p>is_arena_constructable&lt;T>::value is true if the message type T has arena support enabled, and false otherwise.</p><p>is_destructor_skippable&lt;T>::value is true if the message type T has told the arena that it is safe to skip the destructor, and false otherwise.</p><p>This is inside <a href=#Arena>Arena</a> because only <a href=#Arena>Arena</a> has the friend relationships necessary to see the underlying generated code traits.</p><table><tr><th colspan=2><h3 style=margin-top:4px>Members</h3></th></tr></table><h2 id=Arena.is_destructor_skippable>template struct Arena::is_destructor_skippable</h2><p><code>#include &lt;<a href=#>google/protobuf/arena.h</a>><br>namespace <a href=#google.protobuf>google::protobuf</a><br><br>template &lt;typename ></code></p><p></p><table><tr><th colspan=2><h3 style=margin-top:4px>Members</h3></th></tr></table></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/protocol-buffers aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul><script type=text/javascript id=cookiebanner src=https://cdn.jsdelivr.net/gh/dobarkod/cookie-banner@1.2.2/dist/cookiebanner.min.js data-height=50px data-message="Protobuf.dev uses cookies from Google to deliver and enhance the quality of its services and to analyze traffic." data-bg=#ffb data-fg=#000 data-position=bottom data-padding="10px 16px" data-close-text="OK, got it" data-font-size=18px data-moreinfo=https://policies.google.com/technologies/cookies></script></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/protocolbuffers/protobuf aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/protobuf aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul><script type=text/javascript id=cookiebanner src=https://cdn.jsdelivr.net/gh/dobarkod/cookie-banner@1.2.2/dist/cookiebanner.min.js data-height=50px data-message="Protobuf.dev uses cookies from Google to deliver and enhance the quality of its services and to analyze traffic." data-bg=#ffb data-fg=#000 data-position=bottom data-padding="10px 16px" data-close-text="OK, got it" data-font-size=18px data-moreinfo=https://policies.google.com/technologies/cookies></script></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 Google LLC All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small>
<span class=text-white>Hosted by GitHub Pages.</span> <a href=https://docs.github.com/en/site-policy/privacy-policies/github-privacy-statement target=_blank>GitHub Privacy Statement</a></div></div></div></footer></div><script src=/js/main.min.c91cdfdcc1576ecc360abc6f1c3ca0485d047f65ac6d3203ec57ed29e0af808b.js integrity="sha256-yRzf3MFXbsw2CrxvHDygSF0Ef2WsbTID7FftKeCvgIs=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>