

+++
title = "message_differencer.h"
toc_hide = "true"
linkTitle = "C++"
description = "This section contains reference documentation for working with protocol buffer classes in C++."
type = "docs"
+++

<p><code>#include &lt;google/protobuf/util/message_differencer.h&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>This file defines static methods and classes for comparing Protocol Messages. </p><p>Aug. 2008: Added Unknown Fields Comparison for messages. Aug. 2009: Added different options to compare repeated fields. Apr. 2010: Moved field comparison to FieldComparator Sep. 2020: Added option to output map keys in path </p>

<table width="100%"><tr><th colspan="2"><h3 style="margin-top: 4px">Classes in this file</h3></th></tr><tr><td><div><code><a href="#MessageDifferencer">MessageDifferencer</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">A basic differencer that can be used to determine the differences between two specified Protocol Messages. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.IgnoreCriteria">MessageDifferencer::IgnoreCriteria</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Abstract base class from which all <a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> derive. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.MapKeyComparator">MessageDifferencer::MapKeyComparator</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;"><a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> is used to determine if two elements have the same key when comparing elements of a repeated field as a map. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.Reporter">MessageDifferencer::Reporter</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Abstract base class from which all <a href='#MessageDifferencer'>MessageDifferencer</a> reporters derive. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.SpecificField">MessageDifferencer::SpecificField</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Identifies an individual field in a message instance. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.StreamReporter">MessageDifferencer::StreamReporter</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">An implementation of the <a href='#MessageDifferencer'>MessageDifferencer</a> <a href='#MessageDifferencer.Reporter'>Reporter</a> that outputs any differences found in human-readable form to the supplied ZeroCopyOutputStream or Printer. </div></td></tr><tr><td><div><code><a href="#MessageDifferencer.UnpackAnyField">MessageDifferencer::UnpackAnyField</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Class for processing Any deserialization. </div></td></tr><tr><td><div><code><a href="#FieldContext">FieldContext</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">This class provides extra information to the <a href='google.protobuf.util.field_comparator#FieldComparator.Compare'>FieldComparator::Compare</a> function. </div></td></tr></table><table><tr><th colspan="2"><h3 style="margin-top: 4px">File Members</h3><div style="font-style: italic; font-weight: normal;">These definitions are not part of any class.</div></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>typedef</code></td><td style="border-left-width: 0px"id="FieldDescriptorArray"><div style="padding-left: 16px; text-indent: -16px"><code>std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; <b>FieldDescriptorArray</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Defines a collection of field descriptors.  <a href="#FieldDescriptorArray.details">more...</a></div></td></tr></table> <hr><h3 id="FieldDescriptorArray.details"><code>typedef util::FieldDescriptorArray</code></h3><div style="margin-left: 16px"><p>Defines a collection of field descriptors. </p><p>In case of internal google codebase we are using absl::FixedArray instead of vector. It significantly speeds up proto comparison (by ~30%) by reducing the number of malloc/free operations </p>
</div><h2 id="MessageDifferencer">class MessageDifferencer</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>A basic differencer that can be used to determine the differences between two specified Protocol Messages. </p><p>If any differences are found, the Compare method will return false, and any differencer reporter specified via ReportDifferencesTo will have its reporting methods called (see below for implementation of the report). Based off of the original ProtocolDifferencer implementation in //net/proto/protocol-differencer.h (Thanks Todd!).</p>
<p><a href='#MessageDifferencer'>MessageDifferencer</a> REQUIRES that compared messages be the same type, defined as messages that share the same descriptor. If not, the behavior of this class is undefined.</p>
<p>People disagree on what <a href='#MessageDifferencer'>MessageDifferencer</a> should do when asked to compare messages with different descriptors. Some people think it should always return false. Others expect it to try to look for similar fields and compare them anyway &ndash; especially if the descriptors happen to be identical. If we chose either of these behaviors, some set of people would find it surprising, and could end up writing code expecting the other behavior without realizing their error. Therefore, we forbid that usage.</p>
<p>This class is implemented based on the proto2 reflection. The performance should be good enough for normal usages. However, for places where the performance is extremely sensitive, there are several alternatives:</p>
<ul>
  <li>Comparing serialized string Downside: false negatives (there are messages that are the same but their serialized strings are different).</li>
  <li>Equals code generator by compiler plugin (net/proto2/contrib/equals_plugin) Downside: more generated code; maintenance overhead for the additional rule (must be in sync with the original proto_library).</li>
</ul>
<p>Note on handling of google.protobuf.Any: <a href='#MessageDifferencer'>MessageDifferencer</a> automatically unpacks Any::value into a <a href='google.protobuf.message#Message'>Message</a> and compares its individual fields. Messages encoded in a repeated Any cannot be compared using TreatAsMap.</p>
<p>Note on thread-safety: <a href='#MessageDifferencer'>MessageDifferencer</a> is <i>not</i> thread-safe. You need to guard it with a lock to use the same <a href='#MessageDifferencer'>MessageDifferencer</a> instance from multiple threads. Note that it's fine to call static comparison methods (like <a href='#MessageDifferencer.Equals'>MessageDifferencer::Equals</a>) concurrently, but it's not recommended for performance critical code as it leads to extra allocations. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>enum</code></td><td style="border-left-width: 0px"id="MessageDifferencer.MessageFieldComparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>MessageFieldComparison</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;"> <a href="#MessageDifferencer.MessageFieldComparison.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>enum</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Scope"><div style="padding-left: 16px; text-indent: -16px"><code><b>Scope</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;"> <a href="#MessageDifferencer.Scope.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>enum</code></td><td style="border-left-width: 0px"id="MessageDifferencer.FloatComparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>FloatComparison</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">DEPRECATED. Use FieldComparator::FloatComparison instead.  <a href="#MessageDifferencer.FloatComparison.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>enum</code></td><td style="border-left-width: 0px"id="MessageDifferencer.RepeatedFieldComparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>RepeatedFieldComparison</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;"> <a href="#MessageDifferencer.RepeatedFieldComparison.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code><a href='google.protobuf.util.field_comparator#DefaultFieldComparator'>DefaultFieldComparator</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.default_impl"><div style="padding-left: 16px; text-indent: -16px"><code><b>default_impl</b></code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code><a href='google.protobuf.util.field_comparator#FieldComparator'>FieldComparator</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.base"><div style="padding-left: 16px; text-indent: -16px"><code><b>base</b></code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>static bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Equals"><div style="padding-left: 16px; text-indent: -16px"><code><b>Equals</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Determines whether the supplied messages are equal.  <a href="#MessageDifferencer.Equals.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>static bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Equivalent"><div style="padding-left: 16px; text-indent: -16px"><code><b>Equivalent</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Determines whether the supplied messages are equivalent.  <a href="#MessageDifferencer.Equivalent.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>static bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.ApproximatelyEquals"><div style="padding-left: 16px; text-indent: -16px"><code><b>ApproximatelyEquals</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Determines whether the supplied messages are approximately equal.  <a href="#MessageDifferencer.ApproximatelyEquals.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>static bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.ApproximatelyEquivalent"><div style="padding-left: 16px; text-indent: -16px"><code><b>ApproximatelyEquivalent</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Determines whether the supplied messages are approximately equivalent.  <a href="#MessageDifferencer.ApproximatelyEquivalent.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>explicit </code></td><td style="border-left-width: 0px"id="MessageDifferencer.MessageDifferencer"><div style="padding-left: 16px; text-indent: -16px"><code><b>MessageDifferencer</b>()</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">To add a <a href='#MessageDifferencer.Reporter'>Reporter</a>, construct default here, then use ReportDifferencesTo or ReportDifferencesToString. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.~MessageDifferencer"><div style="padding-left: 16px; text-indent: -16px"><code><b>~MessageDifferencer</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsSet"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsSet</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">The elements of the given repeated field will be treated as a set for diffing purposes, so different orderings of the same elements will be considered equal.  <a href="#MessageDifferencer.TreatAsSet.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsSmartSet"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsSmartSet</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsList"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsList</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">The elements of the given repeated field will be treated as a list for diffing purposes, so different orderings of the same elements will NOT be considered equal.  <a href="#MessageDifferencer.TreatAsList.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsSmartList"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsSmartList</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Note that the complexity is similar to treating as SET. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsMap"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsMap</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field, const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * key)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">The elements of the given repeated field will be treated as a map for diffing purposes, with |key| being the map key.  <a href="#MessageDifferencer.TreatAsMap.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsMapWithMultipleFieldsAsKey"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsMapWithMultipleFieldsAsKey</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field, const std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &amp; key_fields)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Same as TreatAsMap except that this method will use multiple fields as the key in comparison.  <a href="#MessageDifferencer.TreatAsMapWithMultipleFieldsAsKey.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsMapWithMultipleFieldPathsAsKey"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsMapWithMultipleFieldPathsAsKey</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field, const std::vector&lt; std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &gt; &amp; key_field_paths)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Same as TreatAsMapWithMultipleFieldsAsKey, except that each of the field do not necessarily need to be a direct subfield.  <a href="#MessageDifferencer.TreatAsMapWithMultipleFieldPathsAsKey.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.TreatAsMapUsingKeyComparator"><div style="padding-left: 16px; text-indent: -16px"><code><b>TreatAsMapUsingKeyComparator</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field, const <a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> * key_comparator)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Uses a custom <a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> to determine if two elements have the same key when comparing a repeated field as a map.  <a href="#MessageDifferencer.TreatAsMapUsingKeyComparator.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code><a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.CreateMultipleFieldsMapKeyComparator"><div style="padding-left: 16px; text-indent: -16px"><code><b>CreateMultipleFieldsMapKeyComparator</b>(const std::vector&lt; std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &gt; &amp; key_field_paths)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Initiates and returns a new instance of MultipleFieldsMapKeyComparator. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.AddIgnoreCriteria"><div style="padding-left: 16px; text-indent: -16px"><code><b>AddIgnoreCriteria</b>(<a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> * ignore_criteria)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Add a custom ignore criteria that is evaluated in addition to the ignored fields added with IgnoreField.  <a href="#MessageDifferencer.AddIgnoreCriteria.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.IgnoreField"><div style="padding-left: 16px; text-indent: -16px"><code><b>IgnoreField</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Indicates that any field with the given descriptor should be ignored for the purposes of comparing two messages.  <a href="#MessageDifferencer.IgnoreField.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_field_comparator"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_field_comparator</b>(<a href='google.protobuf.util.field_comparator#FieldComparator'>FieldComparator</a> * comparator)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Sets the field comparator used to determine differences between protocol buffer fields.  <a href="#MessageDifferencer.set_field_comparator.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SetFractionAndMargin"><div style="padding-left: 16px; text-indent: -16px"><code><b>SetFractionAndMargin</b>(const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field, double fraction, double margin)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">DEPRECATED.  <a href="#MessageDifferencer.SetFractionAndMargin.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_message_field_comparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_message_field_comparison</b>(<a href='#MessageDifferencer.MessageFieldComparison'>MessageFieldComparison</a> comparison)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Sets the type of comparison (as defined in the MessageFieldComparison enumeration above) that is used by this differencer when determining how to compare fields in messages. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_report_matches"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_report_matches</b>(bool report_matches)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Tells the differencer whether or not to report matches.  <a href="#MessageDifferencer.set_report_matches.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_report_moves"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_report_moves</b>(bool report_moves)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Tells the differencer whether or not to report moves (in a set or map repeated field).  <a href="#MessageDifferencer.set_report_moves.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_report_ignores"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_report_ignores</b>(bool report_ignores)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Tells the differencer whether or not to report ignored values.  <a href="#MessageDifferencer.set_report_ignores.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_scope"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_scope</b>(<a href='#MessageDifferencer.Scope'>Scope</a> scope)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Sets the scope of the comparison (as defined in the Scope enumeration above) that is used by this differencer when determining which fields to compare between the messages. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code><a href='#MessageDifferencer.Scope'>Scope</a></code></td><td style="border-left-width: 0px"id="MessageDifferencer.scope"><div style="padding-left: 16px; text-indent: -16px"><code><b>scope</b>()</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Returns the current scope used by this differencer. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_float_comparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_float_comparison</b>(<a href='#MessageDifferencer.FloatComparison'>FloatComparison</a> comparison)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">DEPRECATED.  <a href="#MessageDifferencer.set_float_comparison.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.set_repeated_field_comparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_repeated_field_comparison</b>(<a href='#MessageDifferencer.RepeatedFieldComparison'>RepeatedFieldComparison</a> comparison)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Sets the type of comparison for repeated field (as defined in the RepeatedFieldComparison enumeration above) that is used by this differencer when compare repeated fields in messages. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code><a href='#MessageDifferencer.RepeatedFieldComparison'>RepeatedFieldComparison</a></code></td><td style="border-left-width: 0px"id="MessageDifferencer.repeated_field_comparison"><div style="padding-left: 16px; text-indent: -16px"><code><b>repeated_field_comparison</b>()</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Returns the current repeated field comparison used by this differencer. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Compare"><div style="padding-left: 16px; text-indent: -16px"><code><b>Compare</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Compares the two specified messages, returning true if they are the same, false otherwise.  <a href="#MessageDifferencer.Compare.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.CompareWithFields"><div style="padding-left: 16px; text-indent: -16px"><code><b>CompareWithFields</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &amp; message1_fields, const std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &amp; message2_fields)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Same as above, except comparing only the list of fields specified by the two vectors of FieldDescriptors. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.ReportDifferencesToString"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportDifferencesToString</b>(std::string * output)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Automatically creates a reporter that will output the differences found (if any) to the specified output string pointer.  <a href="#MessageDifferencer.ReportDifferencesToString.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.ReportDifferencesTo"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportDifferencesTo</b>(<a href='#MessageDifferencer.Reporter'>Reporter</a> * reporter)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Tells the <a href='#MessageDifferencer'>MessageDifferencer</a> to report differences via the specified reporter.  <a href="#MessageDifferencer.ReportDifferencesTo.details">more...</a></div></td></tr></table> <hr><h3 id="MessageDifferencer.MessageFieldComparison.details"><code>enum MessageDifferencer::MessageFieldComparison {<br>&nbsp;&nbsp;EQUAL,<br>&nbsp;&nbsp;EQUIVALENT<br>}</code></h3><div style="margin-left: 16px"><p></p><table><tr><td>EQUAL</td><td>Fields must be present in both messages for the messages to be considered the same. </td></tr><tr><td>EQUIVALENT</td><td><p>Fields with default values are considered set for comparison purposes even if not explicitly set in the messages themselves. </p><p>Unknown fields are ignored. </p>
</td></tr></table></div> <hr><h3 id="MessageDifferencer.Scope.details"><code>enum MessageDifferencer::Scope {<br>&nbsp;&nbsp;FULL,<br>&nbsp;&nbsp;PARTIAL<br>}</code></h3><div style="margin-left: 16px"><p></p><table><tr><td>FULL</td><td>All fields of both messages are considered in the comparison. </td></tr><tr><td>PARTIAL</td><td>Only fields present in the first message are considered; fields set only in the second message will be skipped during comparison. </td></tr></table></div> <hr><h3 id="MessageDifferencer.FloatComparison.details"><code>enum MessageDifferencer::FloatComparison {<br>&nbsp;&nbsp;EXACT,<br>&nbsp;&nbsp;APPROXIMATE<br>}</code></h3><div style="margin-left: 16px"><p>DEPRECATED. Use FieldComparator::FloatComparison instead. </p><table><tr><td>EXACT</td><td>Floats and doubles are compared exactly. </td></tr><tr><td>APPROXIMATE</td><td>Floats and doubles are compared using the MathUtil::AlmostEquals method. </td></tr></table></div> <hr><h3 id="MessageDifferencer.RepeatedFieldComparison.details"><code>enum MessageDifferencer::RepeatedFieldComparison {<br>&nbsp;&nbsp;AS_LIST,<br>&nbsp;&nbsp;AS_SET,<br>&nbsp;&nbsp;AS_SMART_LIST,<br>&nbsp;&nbsp;AS_SMART_SET<br>}</code></h3><div style="margin-left: 16px"><p></p><table><tr><td>AS_LIST</td><td><p>Repeated fields are compared in order. </p><p>Differing values at the same index are reported using ReportModified(). If the repeated fields have different numbers of elements, the unpaired elements are reported using ReportAdded() or ReportDeleted(). </p>
</td></tr><tr><td>AS_SET</td><td><p>Treat all the repeated fields as sets. </p><p>See <a href='#MessageDifferencer.TreatAsSet'>TreatAsSet()</a>, as below. </p>
</td></tr><tr><td>AS_SMART_LIST</td><td><p>Similar to AS_SET, but preserve the order and find the longest matching sequence from the first matching element. </p><p>To use an optimal solution, call SetMatchIndicesForSmartListCallback() to pass it in. </p>
</td></tr><tr><td>AS_SMART_SET</td><td>Similar to AS_SET, but match elements with fewest diffs. </td></tr></table></div> <hr><h3 id="MessageDifferencer.Equals.details"><code>static bool MessageDifferencer::Equals(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></h3><div style="margin-left: 16px"><p>Determines whether the supplied messages are equal. </p><p>Equality is defined as all fields within the two messages being set to the same value. Primitive fields and strings are compared by value while embedded messages/groups are compared as if via a recursive call. Use <a href='#MessageDifferencer.Compare'>Compare()</a> with <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a> if some fields should be ignored in the comparison. Use <a href='#MessageDifferencer.Compare'>Compare()</a> with <a href='#MessageDifferencer.TreatAsSet'>TreatAsSet()</a> if there are repeated fields where ordering does not matter.</p>
<p>This method REQUIRES that the two messages have the same <a href='google.protobuf.descriptor#Descriptor'>Descriptor</a> (message1.GetDescriptor() == message2.GetDescriptor()). </p>
</div> <hr><h3 id="MessageDifferencer.Equivalent.details"><code>static bool MessageDifferencer::Equivalent(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></h3><div style="margin-left: 16px"><p>Determines whether the supplied messages are equivalent. </p><p>Equivalency is defined as all fields within the two messages having the same value. This differs from the Equals method above in that fields with default values are considered set to said value automatically. For details on how default values are defined for each field type, see: <a href="/programming-guides/proto?csw=1#optional'></a>. Also, <a href='#MessageDifferencer.Equivalent'>Equivalent()</a> ignores unknown fields. Use <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a> and <a href='#MessageDifferencer.Compare'>Compare()</a> if some fields should be ignored in the comparison.</p>
<p>This method REQUIRES that the two messages have the same <a href='google.protobuf.descriptor#Descriptor'>Descriptor</a> (message1.GetDescriptor() == message2.GetDescriptor()). </p>
</div> <hr><h3 id="MessageDifferencer.ApproximatelyEquals.details"><code>static bool MessageDifferencer::ApproximatelyEquals(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></h3><div style="margin-left: 16px"><p>Determines whether the supplied messages are approximately equal. </p><p>Approximate equality is defined as all fields within the two messages being approximately equal. Primitive (non-float) fields and strings are compared by value, floats are compared using MathUtil::AlmostEquals() and embedded messages/groups are compared as if via a recursive call. Use <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a> and <a href='#MessageDifferencer.Compare'>Compare()</a> if some fields should be ignored in the comparison.</p>
<p>This method REQUIRES that the two messages have the same <a href='google.protobuf.descriptor#Descriptor'>Descriptor</a> (message1.GetDescriptor() == message2.GetDescriptor()). </p>
</div> <hr><h3 id="MessageDifferencer.ApproximatelyEquivalent.details"><code>static bool MessageDifferencer::ApproximatelyEquivalent(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></h3><div style="margin-left: 16px"><p>Determines whether the supplied messages are approximately equivalent. </p><p>Approximate equivalency is defined as all fields within the two messages being approximately equivalent. As in <a href='#MessageDifferencer.ApproximatelyEquals'>MessageDifferencer::ApproximatelyEquals</a>, primitive (non-float) fields and strings are compared by value, floats are compared using MathUtil::AlmostEquals() and embedded messages/groups are compared as if via a recursive call. However, fields with default values are considered set to said value, as per MessageDiffencer::Equivalent. Use <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a> and <a href='#MessageDifferencer.Compare'>Compare()</a> if some fields should be ignored in the comparison.</p>
<p>This method REQUIRES that the two messages have the same <a href='google.protobuf.descriptor#Descriptor'>Descriptor</a> (message1.GetDescriptor() == message2.GetDescriptor()). </p>
</div> <hr><h3 id="MessageDifferencer.TreatAsSet.details"><code>void MessageDifferencer::TreatAsSet(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></h3><div style="margin-left: 16px"><p>The elements of the given repeated field will be treated as a set for diffing purposes, so different orderings of the same elements will be considered equal. </p><p>Elements which are present on both sides of the comparison but which have changed position will be reported with ReportMoved(). Elements which only exist on one side or the other are reported with ReportAdded() and ReportDeleted() regardless of their positions. ReportModified() is never used for this repeated field. If the only differences between the compared messages is that some fields have been moved, then the comparison returns true.</p>
<p>Note that despite the name of this method, this is really comparison as multisets: if one side of the comparison has a duplicate in the repeated field but the other side doesn't, this will count as a mismatch.</p>
<p>If the scope of comparison is set to PARTIAL, then in addition to what's above, extra values added to repeated fields of the second message will not cause the comparison to fail.</p>
<p>Note that set comparison is currently O(k * n^2) (where n is the total number of elements, and k is the average size of each element). In theory it could be made O(n * k) with a more complex hashing implementation. Feel free to contribute one if the current implementation is too slow for you. If partial matching is also enabled, the time complexity will be O(k * n^2</p>
<ul>
  <li>n^3) in which n^3 is the time complexity of the maximum matching algorithm.</li>
</ul>
<p>REQUIRES: field-&gt;is_repeated() and field not registered with TreatAsMap* </p>
</div> <hr><h3 id="MessageDifferencer.TreatAsList.details"><code>void MessageDifferencer::TreatAsList(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></h3><div style="margin-left: 16px"><p>The elements of the given repeated field will be treated as a list for diffing purposes, so different orderings of the same elements will NOT be considered equal. </p><p>REQUIRES: field-&gt;is_repeated() and field not registered with TreatAsMap* </p>
</div> <hr><h3 id="MessageDifferencer.TreatAsMap.details"><code>void MessageDifferencer::TreatAsMap(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * key)</code></h3><div style="margin-left: 16px"><p>The elements of the given repeated field will be treated as a map for diffing purposes, with |key| being the map key. </p><p>Thus, elements with the same key will be compared even if they do not appear at the same index. Differences are reported similarly to <a href='#MessageDifferencer.TreatAsSet'>TreatAsSet()</a>, except that ReportModified() is used to report elements with the same key but different values. Note that if an element is both moved and modified, only ReportModified() will be called. As with TreatAsSet, if the only differences between the compared messages is that some fields have been moved, then the comparison returns true. See TreatAsSet for notes on performance.</p>
<p>REQUIRES: field-&gt;is_repeated() REQUIRES: field-&gt;cpp_type() == <a href='google.protobuf.descriptor#FieldDescriptor.CppType'>FieldDescriptor::CPPTYPE_MESSAGE</a> REQUIRES: key-&gt;containing_type() == field-&gt;message_type() </p>
</div> <hr><h3 id="MessageDifferencer.TreatAsMapWithMultipleFieldsAsKey.details"><code>void MessageDifferencer::TreatAsMapWithMultipleFieldsAsKey(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &amp; key_fields)</code></h3><div style="margin-left: 16px"><p>Same as TreatAsMap except that this method will use multiple fields as the key in comparison. </p><p>All specified fields in 'key_fields' should be present in the compared elements. Two elements will be treated as having the same key iff they have the same value for every specified field. There are two steps in the comparison process. The first one is key matching. Every element from one message will be compared to every element from the other message. Only fields in 'key_fields' are compared in this step to decide if two elements have the same key. The second step is value comparison. Those pairs of elements with the same key (with equal value for every field in 'key_fields') will be compared in this step. Time complexity of the first step is O(s * m * n ^ 2) where s is the average size of the fields specified in 'key_fields', m is the number of fields in 'key_fields' and n is the number of elements. If partial matching is enabled, an extra O(n^3) will be incured by the maximum matching algorithm. The second step is O(k * n) where k is the average size of each element. </p>
</div> <hr><h3 id="MessageDifferencer.TreatAsMapWithMultipleFieldPathsAsKey.details"><code>void MessageDifferencer::TreatAsMapWithMultipleFieldPathsAsKey(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; std::vector&lt; const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * &gt; &gt; &amp; key_field_paths)</code></h3><div style="margin-left: 16px"><p>Same as TreatAsMapWithMultipleFieldsAsKey, except that each of the field do not necessarily need to be a direct subfield. </p><p>Each element in key_field_paths indicate a path from the message being compared, listing successive subfield to reach the key field.</p>
<p>REQUIRES: </p>
<pre>for key_field_path in key_field_paths:
  key_field_path[0]-&gt;containing_type() == field-&gt;message_type()
  for i in [0, key_field_path.size() - 1):
    key_field_path[i+1]-&gt;containing_type() ==
        key_field_path[i]-&gt;message_type()
    key_field_path[i]-&gt;cpp_type() == FieldDescriptor::CPPTYPE_MESSAGE
    !key_field_path[i]-&gt;is_repeated()</pre>
</div> <hr><h3 id="MessageDifferencer.TreatAsMapUsingKeyComparator.details"><code>void MessageDifferencer::TreatAsMapUsingKeyComparator(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> * key_comparator)</code></h3><div style="margin-left: 16px"><p>Uses a custom <a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> to determine if two elements have the same key when comparing a repeated field as a map. </p><p>The caller is responsible to delete the key_comparator. This method varies from TreatAsMapWithMultipleFieldsAsKey only in the first key matching step. Rather than comparing some specified fields, it will invoke the IsMatch method of the given 'key_comparator' to decide if two elements have the same key. </p>
</div> <hr><h3 id="MessageDifferencer.AddIgnoreCriteria.details"><code>void MessageDifferencer::AddIgnoreCriteria(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> * ignore_criteria)</code></h3><div style="margin-left: 16px"><p>Add a custom ignore criteria that is evaluated in addition to the ignored fields added with IgnoreField. </p><p>Takes ownership of ignore_criteria. </p>
</div> <hr><h3 id="MessageDifferencer.IgnoreField.details"><code>void MessageDifferencer::IgnoreField(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field)</code></h3><div style="margin-left: 16px"><p>Indicates that any field with the given descriptor should be ignored for the purposes of comparing two messages. </p><p>This applies to fields nested in the message structure as well as top level ones. When the <a href='#MessageDifferencer'>MessageDifferencer</a> encounters an ignored field, ReportIgnored is called on the reporter, if one is specified.</p>
<p>The only place where the field's 'ignored' status is not applied is when it is being used as a key in a field passed to TreatAsMap or is one of the fields passed to TreatAsMapWithMultipleFieldsAsKey. In this case it is compared in key matching but after that it's ignored in value comparison. </p>
</div> <hr><h3 id="MessageDifferencer.set_field_comparator.details"><code>void MessageDifferencer::set_field_comparator(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='google.protobuf.util.field_comparator#FieldComparator'>FieldComparator</a> * comparator)</code></h3><div style="margin-left: 16px"><p>Sets the field comparator used to determine differences between protocol buffer fields. </p><p>By default it's set to a <a href='google.protobuf.util.field_comparator#DefaultFieldComparator'>DefaultFieldComparator</a> instance. <a href='#MessageDifferencer'>MessageDifferencer</a> doesn't take ownership over the passed object. Note that this method must be called before Compare for the comparator to be used. </p>
</div> <hr><h3 id="MessageDifferencer.SetFractionAndMargin.details"><code>void MessageDifferencer::SetFractionAndMargin(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * field,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double fraction,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double margin)</code></h3><div style="margin-left: 16px"><p>DEPRECATED. </p><p>Pass a <a href='google.protobuf.util.field_comparator#DefaultFieldComparator'>DefaultFieldComparator</a> instance instead. Sets the fraction and margin for the float comparison of a given field. Uses MathUtil::WithinFractionOrMargin to compare the values. NOTE: this method does nothing if differencer's field comparator has been </p>
<pre>set to a custom object.</pre>
<p>REQUIRES: field-&gt;cpp_type == <a href='google.protobuf.descriptor#FieldDescriptor.CppType'>FieldDescriptor::CPPTYPE_DOUBLE</a> or </p>
<pre>field-&gt;cpp_type == FieldDescriptor::CPPTYPE_FLOAT</pre>
<p> REQUIRES: float_comparison_ == APPROXIMATE </p>
</div> <hr><h3 id="MessageDifferencer.set_report_matches.details"><code>void MessageDifferencer::set_report_matches(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool report_matches)</code></h3><div style="margin-left: 16px"><p>Tells the differencer whether or not to report matches. </p><p>This method must be called before Compare. The default for a new differencer is false. </p>
</div> <hr><h3 id="MessageDifferencer.set_report_moves.details"><code>void MessageDifferencer::set_report_moves(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool report_moves)</code></h3><div style="margin-left: 16px"><p>Tells the differencer whether or not to report moves (in a set or map repeated field). </p><p>This method must be called before Compare. The default for a new differencer is true. </p>
</div> <hr><h3 id="MessageDifferencer.set_report_ignores.details"><code>void MessageDifferencer::set_report_ignores(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool report_ignores)</code></h3><div style="margin-left: 16px"><p>Tells the differencer whether or not to report ignored values. </p><p>This method must be called before Compare. The default for a new differencer is true. </p>
</div> <hr><h3 id="MessageDifferencer.set_float_comparison.details"><code>void MessageDifferencer::set_float_comparison(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#MessageDifferencer.FloatComparison'>FloatComparison</a> comparison)</code></h3><div style="margin-left: 16px"><p>DEPRECATED. </p><p>Pass a <a href='google.protobuf.util.field_comparator#DefaultFieldComparator'>DefaultFieldComparator</a> instance instead. Sets the type of comparison (as defined in the FloatComparison enumeration above) that is used by this differencer when comparing float (and double) fields in messages. NOTE: this method does nothing if differencer's field comparator has been </p>
<pre>set to a custom object.</pre>
</div> <hr><h3 id="MessageDifferencer.Compare.details"><code>bool MessageDifferencer::Compare(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></h3><div style="margin-left: 16px"><p>Compares the two specified messages, returning true if they are the same, false otherwise. </p><p>If this method returns false, any changes between the two messages will be reported if a <a href='#MessageDifferencer.Reporter'>Reporter</a> was specified via ReportDifferencesTo (see also ReportDifferencesToString).</p>
<p>This method REQUIRES that the two messages have the same <a href='google.protobuf.descriptor#Descriptor'>Descriptor</a> (message1.GetDescriptor() == message2.GetDescriptor()). </p>
</div> <hr><h3 id="MessageDifferencer.ReportDifferencesToString.details"><code>void MessageDifferencer::ReportDifferencesToString(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::string * output)</code></h3><div style="margin-left: 16px"><p>Automatically creates a reporter that will output the differences found (if any) to the specified output string pointer. </p><p>Note that this method must be called before Compare. </p>
</div> <hr><h3 id="MessageDifferencer.ReportDifferencesTo.details"><code>void MessageDifferencer::ReportDifferencesTo(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#MessageDifferencer.Reporter'>Reporter</a> * reporter)</code></h3><div style="margin-left: 16px"><p>Tells the <a href='#MessageDifferencer'>MessageDifferencer</a> to report differences via the specified reporter. </p><p>Note that this method must be called before Compare for the reporter to be used. It is the responsibility of the caller to delete this object. If the provided pointer equals NULL, the <a href='#MessageDifferencer'>MessageDifferencer</a> stops reporting differences to any previously set reporters or output strings. </p>
</div><h2 id="MessageDifferencer.IgnoreCriteria">class MessageDifferencer::IgnoreCriteria</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>Abstract base class from which all <a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> derive. </p><p>By adding <a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> more complex ignore logic can be implemented. <a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> are registered with AddIgnoreCriteria. For each compared field IsIgnored is called on each added <a href='#MessageDifferencer.IgnoreCriteria'>IgnoreCriteria</a> until one returns true or all return false. IsIgnored is called for fields where at least one side has a value. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.IgnoreCriteria.IgnoreCriteria"><div style="padding-left: 16px; text-indent: -16px"><code><b>IgnoreCriteria</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual </code></td><td style="border-left-width: 0px"id="MessageDifferencer.IgnoreCriteria.~IgnoreCriteria"><div style="padding-left: 16px; text-indent: -16px"><code><b>~IgnoreCriteria</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.IgnoreCriteria.IsIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>IsIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Returns true if the field should be ignored. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.IgnoreCriteria.IsUnknownFieldIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>IsUnknownFieldIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Returns true if the unknown field should be ignored.  <a href="#MessageDifferencer.IgnoreCriteria.IsUnknownFieldIgnored.details">more...</a></div></td></tr></table> <hr><h3 id="MessageDifferencer.IgnoreCriteria.IsUnknownFieldIgnored.details"><code>virtual bool IgnoreCriteria::IsUnknownFieldIgnored(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Returns true if the unknown field should be ignored. </p><p>Note: This will be called for unknown fields as well in which case </p>
<pre>field.field will be null.</pre>
</div><h2 id="MessageDifferencer.MapKeyComparator">class MessageDifferencer::MapKeyComparator</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p><a href='#MessageDifferencer.MapKeyComparator'>MapKeyComparator</a> is used to determine if two elements have the same key when comparing elements of a repeated field as a map. </p><table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.MapKeyComparator.MapKeyComparator"><div style="padding-left: 16px; text-indent: -16px"><code><b>MapKeyComparator</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual </code></td><td style="border-left-width: 0px"id="MessageDifferencer.MapKeyComparator.~MapKeyComparator"><div style="padding-left: 16px; text-indent: -16px"><code><b>~MapKeyComparator</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.MapKeyComparator.IsMatch"><div style="padding-left: 16px; text-indent: -16px"><code><b>IsMatch</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; ) const</code></div></td></tr></table><h2 id="MessageDifferencer.Reporter">class MessageDifferencer::Reporter</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>Abstract base class from which all <a href='#MessageDifferencer'>MessageDifferencer</a> reporters derive. </p><p>The five Report* methods below will be called when a field has been added, deleted, modified, moved, or matched. The third argument is a vector of <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> pointers which describes the chain of fields that was taken to find the current field. For example, for a field found in an embedded message, the vector will contain two FieldDescriptors. The first will be the field of the embedded message itself and the second will be the actual field in the embedded message that was added/deleted/modified. Fields will be reported in PostTraversalOrder. For example, given following proto, if both baz and quux are changed. foo { </p>
<pre>bar {
  baz: 1
  quux: 2
}</pre>
<p> } ReportModified will be invoked with following order:</p>
<ol>
  <li>foo.bar.baz or foo.bar.quux</li>
  <li>foo.bar.quux or foo.bar.baz</li>
</ol>
<ol>
  <li>foo.bar</li>
  <li>foo </li>
</ol>
<p>Known subclasses:</p><ul><li><code><a href="#MessageDifferencer.StreamReporter">StreamReporter</a></code></li></ul><table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.Reporter"><div style="padding-left: 16px; text-indent: -16px"><code><b>Reporter</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual </code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.~Reporter"><div style="padding-left: 16px; text-indent: -16px"><code><b>~Reporter</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportAdded"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportAdded</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a field has been added into Message2. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportDeleted"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportDeleted</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a field has been deleted from Message1. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportModified"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportModified</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that the value of a field has been modified. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportMoved"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportMoved</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a repeated field has been moved to another location.  <a href="#MessageDifferencer.Reporter.ReportMoved.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportMatched"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportMatched</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that two fields match.  <a href="#MessageDifferencer.Reporter.ReportMatched.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that two fields would have been compared, but the comparison has been skipped because the field was marked as 'ignored' using <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a>.  <a href="#MessageDifferencer.Reporter.ReportIgnored.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.Reporter.ReportUnknownFieldIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportUnknownFieldIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Report that an unknown field is ignored.  <a href="#MessageDifferencer.Reporter.ReportUnknownFieldIgnored.details">more...</a></div></td></tr></table> <hr><h3 id="MessageDifferencer.Reporter.ReportMoved.details"><code>virtual void Reporter::ReportMoved(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that a repeated field has been moved to another location. </p><p>This only applies when using TreatAsSet or <a href='#MessageDifferencer.TreatAsMap'>TreatAsMap()</a> &ndash; see below. Also note that for any given field, ReportModified and ReportMoved are mutually exclusive. If a field has been both moved and modified, then only ReportModified will be called. </p>
</div> <hr><h3 id="MessageDifferencer.Reporter.ReportMatched.details"><code>virtual void Reporter::ReportMatched(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that two fields match. </p><p>Useful for doing side-by-side diffs. This function is mutually exclusive with ReportModified and ReportMoved. Note that you must call set_report_matches(true) before calling Compare to make use of this function. </p>
</div> <hr><h3 id="MessageDifferencer.Reporter.ReportIgnored.details"><code>virtual void Reporter::ReportIgnored(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that two fields would have been compared, but the comparison has been skipped because the field was marked as 'ignored' using <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a>. </p><p>This function is mutually exclusive with all the other Report() functions.</p>
<p>The contract of ReportIgnored is slightly different than the other Report() functions, in that |field_path.back().index| is always equal to -1, even if the last field is repeated. This is because while the other Report() functions indicate where in a repeated field the action (Addition, Deletion, etc...) happened, when a repeated field is 'ignored', the differencer simply calls ReportIgnored on the repeated field as a whole and moves on without looking at its individual elements.</p>
<p>Furthermore, <a href='#MessageDifferencer.Reporter.ReportIgnored'>ReportIgnored()</a> does not indicate whether the fields were in fact equal or not, as <a href='#MessageDifferencer.Compare'>Compare()</a> does not inspect these fields at all. It is up to the <a href='#MessageDifferencer.Reporter'>Reporter</a> to decide whether the fields are equal or not (perhaps with a second call to <a href='#MessageDifferencer.Compare'>Compare()</a>), if it cares. </p>
</div> <hr><h3 id="MessageDifferencer.Reporter.ReportUnknownFieldIgnored.details"><code>virtual void Reporter::ReportUnknownFieldIgnored(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Report that an unknown field is ignored. </p><p>(see comment above). Note this is a different function since the last <a href='#MessageDifferencer.SpecificField'>SpecificField</a> in field path has a null field. This could break existing <a href='#MessageDifferencer.Reporter'>Reporter</a>. </p>
</div><h2 id="MessageDifferencer.SpecificField">struct MessageDifferencer::SpecificField</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>Identifies an individual field in a message instance. </p><p>Used for field_path, below. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.field"><div style="padding-left: 16px; text-indent: -16px"><code><b>field</b> = = nullptr</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">For known fields, "field" is filled in and "unknown_field_number" is -1.  <a href="#MessageDifferencer.SpecificField.field.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>int</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_number"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_number</b> = = -1</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>UnknownField::Type</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_type"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_type</b> = = UnknownField::Type::TYPE_VARINT</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>int</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.index"><div style="padding-left: 16px; text-indent: -16px"><code><b>index</b> = = -1</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">If this a repeated field, "index" is the index within it.  <a href="#MessageDifferencer.SpecificField.index.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>int</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.new_index"><div style="padding-left: 16px; text-indent: -16px"><code><b>new_index</b> = = -1</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">If "field" is a repeated field which is being treated as a map or a set (see <a href='#MessageDifferencer.TreatAsMap'>TreatAsMap()</a> and <a href='#MessageDifferencer.TreatAsSet'>TreatAsSet()</a>, below), new_index indicates the index the position to which the element has moved.  <a href="#MessageDifferencer.SpecificField.new_index.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>const <a href='google.protobuf.unknown_field_set#UnknownFieldSet'>UnknownFieldSet</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_set1"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_set1</b> = = nullptr</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">For unknown fields, these are the pointers to the <a href='google.protobuf.unknown_field_set#UnknownFieldSet'>UnknownFieldSet</a> containing the unknown fields.  <a href="#MessageDifferencer.SpecificField.unknown_field_set1.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>const <a href='google.protobuf.unknown_field_set#UnknownFieldSet'>UnknownFieldSet</a> *</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_set2"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_set2</b> = = nullptr</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>int</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_index1"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_index1</b> = = -1</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">For unknown fields, these are the index of the field within the UnknownFieldSets.  <a href="#MessageDifferencer.SpecificField.unknown_field_index1.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>int</code></td><td style="border-left-width: 0px"id="MessageDifferencer.SpecificField.unknown_field_index2"><div style="padding-left: 16px; text-indent: -16px"><code><b>unknown_field_index2</b> = = -1</code></div></td></tr></table> <hr><h3 id="MessageDifferencer.SpecificField.field.details"><code>const <a href='google.protobuf.descriptor#FieldDescriptor'>FieldDescriptor</a> * SpecificField::field = = nullptr</code></h3><div style="margin-left: 16px"><p>For known fields, "field" is filled in and "unknown_field_number" is -1. </p><p>For unknown fields, "field" is NULL, "unknown_field_number" is the field number, and "unknown_field_type" is its type. </p>
</div> <hr><h3 id="MessageDifferencer.SpecificField.index.details"><code>int SpecificField::index = = -1</code></h3><div style="margin-left: 16px"><p>If this a repeated field, "index" is the index within it. </p><p>For unknown fields, this is the index of the field among all unknown fields of the same field number and type. </p>
</div> <hr><h3 id="MessageDifferencer.SpecificField.new_index.details"><code>int SpecificField::new_index = = -1</code></h3><div style="margin-left: 16px"><p>If "field" is a repeated field which is being treated as a map or a set (see <a href='#MessageDifferencer.TreatAsMap'>TreatAsMap()</a> and <a href='#MessageDifferencer.TreatAsSet'>TreatAsSet()</a>, below), new_index indicates the index the position to which the element has moved. </p><p>If the element has not moved, "new_index" will have the same value as "index". </p>
</div> <hr><h3 id="MessageDifferencer.SpecificField.unknown_field_set1.details"><code>const <a href='google.protobuf.unknown_field_set#UnknownFieldSet'>UnknownFieldSet</a> * SpecificField::unknown_field_set1 = = nullptr</code></h3><div style="margin-left: 16px"><p>For unknown fields, these are the pointers to the <a href='google.protobuf.unknown_field_set#UnknownFieldSet'>UnknownFieldSet</a> containing the unknown fields. </p><p>In certain cases (e.g. proto1's MessageSet, or nested groups of unknown fields), these may differ from the messages' internal UnknownFieldSets. </p>
</div> <hr><h3 id="MessageDifferencer.SpecificField.unknown_field_index1.details"><code>int SpecificField::unknown_field_index1 = = -1</code></h3><div style="margin-left: 16px"><p>For unknown fields, these are the index of the field within the UnknownFieldSets. </p><p>One or the other will be -1 when reporting an addition or deletion. </p>
</div><h2 id="MessageDifferencer.StreamReporter">class MessageDifferencer::StreamReporter: public <a href="#MessageDifferencer.Reporter">Reporter</a></h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>An implementation of the <a href='#MessageDifferencer'>MessageDifferencer</a> <a href='#MessageDifferencer.Reporter'>Reporter</a> that outputs any differences found in human-readable form to the supplied ZeroCopyOutputStream or Printer. </p><p>If a printer is used, the delimiter <i>must</i> be '$'.</p>
<p>WARNING: this reporter does not necessarily flush its output until it is destroyed. As a result, it is not safe to assume the output is valid or complete until after you destroy the reporter. For example, if you use a <a href='#MessageDifferencer.StreamReporter'>StreamReporter</a> to write to a StringOutputStream, the target string may contain uninitialized data until the reporter is destroyed. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>explicit </code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.StreamReporter"><div style="padding-left: 16px; text-indent: -16px"><code><b>StreamReporter</b>(<a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> * output)</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>explicit </code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.StreamReporter"><div style="padding-left: 16px; text-indent: -16px"><code><b>StreamReporter</b>(<a href='google.protobuf.io.printer#Printer'>io::Printer</a> * printer)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">delimiter '$' </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.~StreamReporter"><div style="padding-left: 16px; text-indent: -16px"><code><b>~StreamReporter</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.set_report_modified_aggregates"><div style="padding-left: 16px; text-indent: -16px"><code><b>set_report_modified_aggregates</b>(bool report)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">When set to true, the stream reporter will also output aggregates nodes (i.e.  <a href="#MessageDifferencer.StreamReporter.set_report_modified_aggregates.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportAdded"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportAdded</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a field has been added into Message2. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportDeleted"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportDeleted</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a field has been deleted from Message1. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportModified"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportModified</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that the value of a field has been modified. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportMoved"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportMoved</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that a repeated field has been moved to another location.  <a href="#MessageDifferencer.StreamReporter.ReportMoved.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportMatched"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportMatched</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that two fields match.  <a href="#MessageDifferencer.StreamReporter.ReportMatched.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Reports that two fields would have been compared, but the comparison has been skipped because the field was marked as 'ignored' using <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a>.  <a href="#MessageDifferencer.StreamReporter.ReportIgnored.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.ReportUnknownFieldIgnored"><div style="padding-left: 16px; text-indent: -16px"><code><b>ReportUnknownFieldIgnored</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; , const <a href='google.protobuf.message#Message'>Message</a> &amp; , const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Report that an unknown field is ignored.  <a href="#MessageDifferencer.StreamReporter.ReportUnknownFieldIgnored.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.SetMessages"><div style="padding-left: 16px; text-indent: -16px"><code><b>SetMessages</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message1, const <a href='google.protobuf.message#Message'>Message</a> &amp; message2)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Messages that are being compared must be provided to <a href='#MessageDifferencer.StreamReporter'>StreamReporter</a> prior to processing. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>protected virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.PrintPath"><div style="padding-left: 16px; text-indent: -16px"><code><b>PrintPath</b>(const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path, bool left_side)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Prints the specified path of fields to the buffer. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>protected virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.PrintValue"><div style="padding-left: 16px; text-indent: -16px"><code><b>PrintValue</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; message, const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path, bool left_side)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Prints the value of fields to the buffer.  <a href="#MessageDifferencer.StreamReporter.PrintValue.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>protected virtual void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.PrintUnknownFieldValue"><div style="padding-left: 16px; text-indent: -16px"><code><b>PrintUnknownFieldValue</b>(const <a href='google.protobuf.unknown_field_set#UnknownField'>UnknownField</a> * unknown_field)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Prints the specified path of unknown fields to the buffer. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>protected void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.Print"><div style="padding-left: 16px; text-indent: -16px"><code><b>Print</b>(const std::string &amp; str)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Just print a string. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>protected void</code></td><td style="border-left-width: 0px"id="MessageDifferencer.StreamReporter.PrintMapKey"><div style="padding-left: 16px; text-indent: -16px"><code><b>PrintMapKey</b>(const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path, bool left_side, const <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &amp; specific_field, size_t target_field_index)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">helper function for PrintPath that contains logic for printing maps </div></td></tr></table> <hr><h3 id="MessageDifferencer.StreamReporter.set_report_modified_aggregates.details"><code>void StreamReporter::set_report_modified_aggregates(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool report)</code></h3><div style="margin-left: 16px"><p>When set to true, the stream reporter will also output aggregates nodes (i.e. </p><p>messages and groups) whose subfields have been modified. When false, will only report the individual subfields. Defaults to false. </p>
</div> <hr><h3 id="MessageDifferencer.StreamReporter.ReportMoved.details"><code>virtual void StreamReporter::ReportMoved(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that a repeated field has been moved to another location. </p><p>This only applies when using TreatAsSet or <a href='#MessageDifferencer.TreatAsMap'>TreatAsMap()</a> &ndash; see below. Also note that for any given field, ReportModified and ReportMoved are mutually exclusive. If a field has been both moved and modified, then only ReportModified will be called. </p>
</div> <hr><h3 id="MessageDifferencer.StreamReporter.ReportMatched.details"><code>virtual void StreamReporter::ReportMatched(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that two fields match. </p><p>Useful for doing side-by-side diffs. This function is mutually exclusive with ReportModified and ReportMoved. Note that you must call set_report_matches(true) before calling Compare to make use of this function. </p>
</div> <hr><h3 id="MessageDifferencer.StreamReporter.ReportIgnored.details"><code>virtual void StreamReporter::ReportIgnored(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Reports that two fields would have been compared, but the comparison has been skipped because the field was marked as 'ignored' using <a href='#MessageDifferencer.IgnoreField'>IgnoreField()</a>. </p><p>This function is mutually exclusive with all the other Report() functions.</p>
<p>The contract of ReportIgnored is slightly different than the other Report() functions, in that |field_path.back().index| is always equal to -1, even if the last field is repeated. This is because while the other Report() functions indicate where in a repeated field the action (Addition, Deletion, etc...) happened, when a repeated field is 'ignored', the differencer simply calls ReportIgnored on the repeated field as a whole and moves on without looking at its individual elements.</p>
<p>Furthermore, <a href='#MessageDifferencer.StreamReporter.ReportIgnored'>ReportIgnored()</a> does not indicate whether the fields were in fact equal or not, as <a href='#MessageDifferencer.Compare'>Compare()</a> does not inspect these fields at all. It is up to the <a href='#MessageDifferencer.Reporter'>Reporter</a> to decide whether the fields are equal or not (perhaps with a second call to <a href='#MessageDifferencer.Compare'>Compare()</a>), if it cares. </p>
</div> <hr><h3 id="MessageDifferencer.StreamReporter.ReportUnknownFieldIgnored.details"><code>virtual void StreamReporter::ReportUnknownFieldIgnored(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; )</code></h3><div style="margin-left: 16px"><p>Report that an unknown field is ignored. </p><p>(see comment above). Note this is a different function since the last <a href='#MessageDifferencer.SpecificField'>SpecificField</a> in field path has a null field. This could break existing <a href='#MessageDifferencer.Reporter'>Reporter</a>. </p>
</div> <hr><h3 id="MessageDifferencer.StreamReporter.PrintValue.details"><code>protected virtual void StreamReporter::PrintValue(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.message#Message'>Message</a> &amp; message,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; <a href='#MessageDifferencer.SpecificField'>SpecificField</a> &gt; &amp; field_path,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool left_side)</code></h3><div style="margin-left: 16px"><p>Prints the value of fields to the buffer. </p><p>left_side is true if the given message is from the left side of the comparison, false if it was the right. This is relevant only to decide whether to follow unknown_field_index1 or unknown_field_index2 when an unknown field is encountered in field_path. </p>
</div><h2 id="MessageDifferencer.UnpackAnyField">class MessageDifferencer::UnpackAnyField</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>Class for processing Any deserialization. </p><p>This logic is used by both the <a href='#MessageDifferencer'>MessageDifferencer</a> and <a href='#MessageDifferencer.StreamReporter'>StreamReporter</a> classes. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.UnpackAnyField.UnpackAnyField"><div style="padding-left: 16px; text-indent: -16px"><code><b>UnpackAnyField</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="MessageDifferencer.UnpackAnyField.~UnpackAnyField"><div style="padding-left: 16px; text-indent: -16px"><code><b>~UnpackAnyField</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>bool</code></td><td style="border-left-width: 0px"id="MessageDifferencer.UnpackAnyField.UnpackAny"><div style="padding-left: 16px; text-indent: -16px"><code><b>UnpackAny</b>(const <a href='google.protobuf.message#Message'>Message</a> &amp; any, std::unique_ptr&lt; <a href='google.protobuf.message#Message'>Message</a> &gt; * data)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">If "any" is of type google.protobuf.Any, extract its payload using <a href='google.protobuf.dynamic_message#DynamicMessageFactory'>DynamicMessageFactory</a> and store in "data". </div></td></tr></table><h2 id="FieldContext">class FieldContext</h2><p><code>#include &lt;<a href="#">google/protobuf/util/message_differencer.h</a>&gt;<br>namespace <a href="#google.protobuf.util">google::protobuf::util</a></code></p><p>This class provides extra information to the <a href='google.protobuf.util.field_comparator#FieldComparator.Compare'>FieldComparator::Compare</a> function. </p><table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>explicit </code></td><td style="border-left-width: 0px"id="FieldContext.FieldContext"><div style="padding-left: 16px; text-indent: -16px"><code><b>FieldContext</b>(std::vector&lt; <a href='#MessageDifferencer.SpecificField'>MessageDifferencer::SpecificField</a> &gt; * parent_fields)</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>std::vector&lt; <a href='#MessageDifferencer.SpecificField'>MessageDifferencer::SpecificField</a> &gt; *</code></td><td style="border-left-width: 0px"id="FieldContext.parent_fields"><div style="padding-left: 16px; text-indent: -16px"><code><b>parent_fields</b>() const</code></div></td></tr></table>
