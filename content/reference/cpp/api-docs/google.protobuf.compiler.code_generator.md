+++
title = "code_generator.h"
toc_hide = "true"
linkTitle = "C++"
description = "This section contains reference documentation for working with protocol buffer classes in C++."
type = "docs"
+++

<p><code>#include &lt;google/protobuf/compiler/code_generator.h&gt;<br>namespace <a href="#google.protobuf.compiler">google::protobuf::compiler</a></code></p><p>Defines the abstract interface implemented by each of the language-specific code generators. </p><table width="100%"><tr><th colspan="2"><h3 style="margin-top: 4px">Classes in this file</h3></th></tr><tr><td><div><code><a href="#CodeGenerator">CodeGenerator</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">The abstract interface to a class which generates code implementing a particular proto file in a particular language. </div></td></tr><tr><td><div><code><a href="#GeneratorContext">GeneratorContext</a></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">CodeGenerators generate one or more files in a given directory. </div></td></tr></table><table><tr><th colspan="2"><h3 style="margin-top: 4px">File Members</h3><div style="font-style: italic; font-weight: normal;">These definitions are not part of any class.</div></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>typedef</code></td><td style="border-left-width: 0px"id="OutputDirectory"><div style="padding-left: 16px; text-indent: -16px"><code><a href='#GeneratorContext'>GeneratorContext</a> <b>OutputDirectory</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">The type <a href='#GeneratorContext'>GeneratorContext</a> was once called OutputDirectory.  <a href="#OutputDirectory.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>void</code></td><td style="border-left-width: 0px"id="ParseGeneratorParameter"><div style="padding-left: 16px; text-indent: -16px"><code><b>ParseGeneratorParameter</b>(const std::string &amp; , std::vector&lt; std::pair&lt; std::string, std::string &gt; &gt; * )</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Several code generators treat the parameter argument as holding a list of options separated by commas.  <a href="#ParseGeneratorParameter.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>std::string</code></td><td style="border-left-width: 0px"id="StripProto"><div style="padding-left: 16px; text-indent: -16px"><code><b>StripProto</b>(const std::string &amp; filename)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Strips ".proto" or ".protodevel" from the end of a filename. </div></td></tr></table> <hr><h3 id="OutputDirectory.details"><code>typedef compiler::OutputDirectory</code></h3><div style="margin-left: 16px"><p>The type <a href='#GeneratorContext'>GeneratorContext</a> was once called OutputDirectory. </p><p>This typedef provides backward compatibility. </p>
</div> <hr><h3 id="ParseGeneratorParameter.details"><code>void compiler::ParseGeneratorParameter(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt; std::pair&lt; std::string, std::string &gt; &gt; * )</code></h3><div style="margin-left: 16px"><p>Several code generators treat the parameter argument as holding a list of options separated by commas. </p><p>This helper function parses a set of comma-delimited name/value pairs: e.g., "foo=bar,baz,qux=corge" parses to the pairs: </p>

<pre>("foo", "bar"), ("baz", ""), ("qux", "corge")</pre>

</div><h2 id="CodeGenerator">class CodeGenerator</h2><p><code>#include &lt;<a href="#">google/protobuf/compiler/code_generator.h</a>&gt;<br>namespace <a href="#google.protobuf.compiler">google::protobuf::compiler</a></code></p><p>The abstract interface to a class which generates code implementing a particular proto file in a particular language. </p><p>A number of these may be registered with <a href='google.protobuf.compiler.command_line_interface#CommandLineInterface'>CommandLineInterface</a> to support various languages. </p>
<p>Known subclasses:</p><ul><li><code><a href="google.protobuf.compiler.cpp_generator#CppGenerator">CppGenerator</a></code></li><li><code><a href="google.protobuf.compiler.csharp_generator#Generator">Generator</a></code></li><li><code><a href="google.protobuf.compiler.java_generator#JavaGenerator">JavaGenerator</a></code></li><li><code><a href="google.protobuf.compiler.js_generator#Generator">Generator</a></code></li><li><code><a href="google.protobuf.compiler.objectivec_generator#ObjectiveCGenerator">ObjectiveCGenerator</a></code></li><li><code><a href="google.protobuf.compiler.python_generator#Generator">Generator</a></code></li><li><code><a href="google.protobuf.compiler.ruby_generator#Generator">Generator</a></code></li></ul><table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>enum</code></td><td style="border-left-width: 0px"id="CodeGenerator.Feature"><div style="padding-left: 16px; text-indent: -16px"><code><b>Feature</b></code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Sync with plugin.proto.  <a href="#CodeGenerator.Feature.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="CodeGenerator.CodeGenerator"><div style="padding-left: 16px; text-indent: -16px"><code><b>CodeGenerator</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual </code></td><td style="border-left-width: 0px"id="CodeGenerator.~CodeGenerator"><div style="padding-left: 16px; text-indent: -16px"><code><b>~CodeGenerator</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="CodeGenerator.Generate"><div style="padding-left: 16px; text-indent: -16px"><code><b>Generate</b>(const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * file, const std::string &amp; parameter, <a href='#GeneratorContext'>GeneratorContext</a> * generator_context, std::string * error) const  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Generates code for the given proto file, generating one or more files in the given output directory.  <a href="#CodeGenerator.Generate.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="CodeGenerator.GenerateAll"><div style="padding-left: 16px; text-indent: -16px"><code><b>GenerateAll</b>(const std::vector&lt; const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * &gt; &amp; files, const std::string &amp; parameter, <a href='#GeneratorContext'>GeneratorContext</a> * generator_context, std::string * error) const</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Generates code for all given proto files.  <a href="#CodeGenerator.GenerateAll.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual uint64_t</code></td><td style="border-left-width: 0px"id="CodeGenerator.GetSupportedFeatures"><div style="padding-left: 16px; text-indent: -16px"><code><b>GetSupportedFeatures</b>() const</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Implement this to indicate what features this code generator supports.  <a href="#CodeGenerator.GetSupportedFeatures.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual bool</code></td><td style="border-left-width: 0px"id="CodeGenerator.HasGenerateAll"><div style="padding-left: 16px; text-indent: -16px"><code><b>HasGenerateAll</b>() const</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">This is no longer used, but this class is part of the opensource protobuf library, so it has to remain to keep vtables the same for the current version of the library.  <a href="#CodeGenerator.HasGenerateAll.details">more...</a></div></td></tr></table> <hr><h3 id="CodeGenerator.Feature.details"><code>enum CodeGenerator::Feature {<br>&nbsp;&nbsp;FEATURE_PROTO3_OPTIONAL = = 1<br>}</code></h3><div style="margin-left: 16px"><p>Sync with plugin.proto. </p><table><tr><td>FEATURE_PROTO3_OPTIONAL</td><td></td></tr></table></div> <hr><h3 id="CodeGenerator.Generate.details"><code>virtual bool CodeGenerator::Generate(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * file,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; parameter,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#GeneratorContext'>GeneratorContext</a> * generator_context,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::string * error) const  = 0</code></h3><div style="margin-left: 16px"><p>Generates code for the given proto file, generating one or more files in the given output directory. </p><p>A parameter to be passed to the generator can be specified on the command line. This is intended to be used to pass generator specific parameters. It is empty if no parameter was given. ParseGeneratorParameter (below), can be used to accept multiple parameters within the single parameter command line flag.</p>
<p>Returns true if successful. Otherwise, sets *error to a description of the problem (e.g. "invalid parameter") and returns false. </p>
</div> <hr><h3 id="CodeGenerator.GenerateAll.details"><code>virtual bool CodeGenerator::GenerateAll(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::vector&lt; const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * &gt; &amp; files,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; parameter,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#GeneratorContext'>GeneratorContext</a> * generator_context,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::string * error) const</code></h3><div style="margin-left: 16px"><p>Generates code for all given proto files. </p><p>WARNING: The canonical code generator design produces one or two output files per input .proto file, and we do not wish to encourage alternate designs.</p>
<p>A parameter is given as passed on the command line, as in |Generate()| above.</p>
<p>Returns true if successful. Otherwise, sets *error to a description of the problem (e.g. "invalid parameter") and returns false. </p>
</div> <hr><h3 id="CodeGenerator.GetSupportedFeatures.details"><code>virtual uint64_t CodeGenerator::GetSupportedFeatures() const</code></h3><div style="margin-left: 16px"><p>Implement this to indicate what features this code generator supports. </p><p>This should be a bitwise OR of features from the Features enum in plugin.proto. </p>
</div> <hr><h3 id="CodeGenerator.HasGenerateAll.details"><code>virtual bool CodeGenerator::HasGenerateAll() const</code></h3><div style="margin-left: 16px"><p>This is no longer used, but this class is part of the opensource protobuf library, so it has to remain to keep vtables the same for the current version of the library. </p><p>When protobufs does a api breaking change, the method can be removed. </p>
</div><h2 id="GeneratorContext">class GeneratorContext</h2><p><code>#include &lt;<a href="#">google/protobuf/compiler/code_generator.h</a>&gt;<br>namespace <a href="#google.protobuf.compiler">google::protobuf::compiler</a></code></p><p>CodeGenerators generate one or more files in a given directory. </p><p>This abstract interface represents the directory to which the <a href='#CodeGenerator'>CodeGenerator</a> is to write and other information about the context in which the Generator runs. </p>
<table><tr><th colspan="2"><h3 style="margin-top: 4px">Members</h3></th></tr><tr><td style="border-right-width: 0px; text-align: right;"><code></code></td><td style="border-left-width: 0px"id="GeneratorContext.GeneratorContext"><div style="padding-left: 16px; text-indent: -16px"><code><b>GeneratorContext</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual </code></td><td style="border-left-width: 0px"id="GeneratorContext.~GeneratorContext"><div style="padding-left: 16px; text-indent: -16px"><code><b>~GeneratorContext</b>()</code></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> *</code></td><td style="border-left-width: 0px"id="GeneratorContext.Open"><div style="padding-left: 16px; text-indent: -16px"><code><b>Open</b>(const std::string &amp; filename)  = 0</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Opens the given file, truncating it if it exists, and returns a ZeroCopyOutputStream that writes to the file.  <a href="#GeneratorContext.Open.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> *</code></td><td style="border-left-width: 0px"id="GeneratorContext.OpenForAppend"><div style="padding-left: 16px; text-indent: -16px"><code><b>OpenForAppend</b>(const std::string &amp; filename)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Similar to <a href='#GeneratorContext.Open'>Open()</a> but the output will be appended to the file if exists. </div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> *</code></td><td style="border-left-width: 0px"id="GeneratorContext.OpenForInsert"><div style="padding-left: 16px; text-indent: -16px"><code><b>OpenForInsert</b>(const std::string &amp; filename, const std::string &amp; insertion_point)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Creates a ZeroCopyOutputStream which will insert code into the given file at the given insertion point.  <a href="#GeneratorContext.OpenForInsert.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> *</code></td><td style="border-left-width: 0px"id="GeneratorContext.OpenForInsertWithGeneratedCodeInfo"><div style="padding-left: 16px; text-indent: -16px"><code><b>OpenForInsertWithGeneratedCodeInfo</b>(const std::string &amp; filename, const std::string &amp; insertion_point, const google::protobuf::GeneratedCodeInfo &amp; info)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Similar to OpenForInsert, but if <code>info</code> is non-empty, will open (or create) filename.pb.meta and insert info at the appropriate place with the necessary shifts.  <a href="#GeneratorContext.OpenForInsertWithGeneratedCodeInfo.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="GeneratorContext.ListParsedFiles"><div style="padding-left: 16px; text-indent: -16px"><code><b>ListParsedFiles</b>(std::vector&lt; const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * &gt; * output)</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Returns a vector of FileDescriptors for all the files being compiled in this run.  <a href="#GeneratorContext.ListParsedFiles.details">more...</a></div></td></tr><tr><td style="border-right-width: 0px; text-align: right;"><code>virtual void</code></td><td style="border-left-width: 0px"id="GeneratorContext.GetCompilerVersion"><div style="padding-left: 16px; text-indent: -16px"><code><b>GetCompilerVersion</b>(Version * version) const</code></div><div style="font-style: italic; margin-top: 4px; margin-left: 16px;">Retrieves the version number of the protocol compiler associated with this <a href='#GeneratorContext'>GeneratorContext</a>. </div></td></tr></table> <hr><h3 id="GeneratorContext.Open.details"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> * <br>&nbsp;&nbsp;&nbsp;&nbsp;GeneratorContext::Open(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; filename)  = 0</code></h3><div style="margin-left: 16px"><p>Opens the given file, truncating it if it exists, and returns a ZeroCopyOutputStream that writes to the file. </p><p>The caller takes ownership of the returned object. This method never fails (a dummy stream will be returned instead).</p>
<p>The filename given should be relative to the root of the source tree. E.g. the C++ generator, when generating code for "foo/bar.proto", will generate the files "foo/bar.pb.h" and "foo/bar.pb.cc"; note that "foo/" is included in these filenames. The filename is not allowed to contain "." or ".." components. </p>
</div> <hr><h3 id="GeneratorContext.OpenForInsert.details"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> * <br>&nbsp;&nbsp;&nbsp;&nbsp;GeneratorContext::OpenForInsert(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; filename,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; insertion_point)</code></h3><div style="margin-left: 16px"><p>Creates a ZeroCopyOutputStream which will insert code into the given file at the given insertion point. </p><p>See plugin.proto (<a href='google.protobuf.compiler.plugin.pb'>plugin.pb.h</a>) for more information on insertion points. The default implementation assert-fails &ndash; it exists only for backwards-compatibility.</p>
<p>WARNING: This feature is currently EXPERIMENTAL and is subject to change. </p>
</div> <hr><h3 id="GeneratorContext.OpenForInsertWithGeneratedCodeInfo.details"><code>virtual <a href='google.protobuf.io.zero_copy_stream#ZeroCopyOutputStream'>io::ZeroCopyOutputStream</a> * <br>&nbsp;&nbsp;&nbsp;&nbsp;GeneratorContext::OpenForInsertWithGeneratedCodeInfo(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; filename,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const std::string &amp; insertion_point,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const google::protobuf::GeneratedCodeInfo &amp; info)</code></h3><div style="margin-left: 16px"><p>Similar to OpenForInsert, but if <code>info</code> is non-empty, will open (or create) filename.pb.meta and insert info at the appropriate place with the necessary shifts. </p><p>The default implementation ignores <code>info</code>.</p>
<p>WARNING: This feature will be REMOVED in the near future. </p>
</div> <hr><h3 id="GeneratorContext.ListParsedFiles.details"><code>virtual void GeneratorContext::ListParsedFiles(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::vector&lt; const <a href='google.protobuf.descriptor#FileDescriptor'>FileDescriptor</a> * &gt; * output)</code></h3><div style="margin-left: 16px"><p>Returns a vector of FileDescriptors for all the files being compiled in this run. </p><p>Useful for languages, such as Go, that treat files differently when compiled as a set rather than individually. </p>
</div>
